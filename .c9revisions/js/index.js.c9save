{"ts":1370284124092,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1370284051587,"patch":[[{"diffs":[[1,"// IE becomes very unhappy when we forget. Let's not make IE unhappy\r\nif (typeof(console) === 'undefined') {var console = {};console.log = console.error = console.info = console.debug = console.warn = console.trace = console.dir = console.dirxml = console.groupEnd = console.time = console.timeEnd = console.assert = console.profile = function () {};}\r\nif (typeof(console.group) === 'undefined') {console.group = console.log; console.groupEnd = function () {}}\r\nif (!String.prototype.trim) { String.prototype.trim = function () { return this.replace(/^\\s+|\\s+$/g, ''); };}\r\n\r\n/*set color opacity - helps overlaying column*/\r\nHighcharts.getOptions().colors = Highcharts.map(Highcharts.getOptions().colors, function (color) {\r\n    \treturn Highcharts.Color(color).setOpacity(0.75).get('rgba');\r\n\t});\r\nvar chart, subChart, grid;\r\nvar colors = Highcharts.getOptions().colors;\r\n\r\n/*jq extensions*/\r\n$.extend({\r\n\tdistinct : function (arr) {\r\n\t\treturn $.grep(arr, function (el, index) {\r\n\t\t\treturn index == $.inArray(el, arr);\r\n\t\t});\r\n\t},\r\n\tremoveEmpty : function (arr) {\r\n\t\treturn $.grep(arr, function (i) {\r\n\t\t\tif (i != \"\") {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n});\r\n\r\n/*our view model */\r\n$V = {\r\n\tBudget : {},\r\n\tActual : {},\r\n\tCarryOver: {},\r\n\tchartOptions : {},\r\n\tdrawChart : function () {\r\n\t\tchart = drawAreaChart($V.chartOptions);\r\n\t}\r\n};\r\n\r\n$V.StartDate = '4/1/2013';\r\n$V.EndDate = '3/31/2014';\r\n\r\n/*configuration & helpers*/\r\n$C = {\r\n\tIsDev8 : window.location.href.toLowerCase().indexOf('file:') >= 0,\r\n\trnd : (new Date()).getTime(),\r\n\tInvoiceExpenseListUrl : function () {\r\n\t\treturn $C.IsDev8 ? './mock/InvoiceExpenseList.js?callback=?' : '/_layouts/com.mizuho.sharepoint.portal/MrHandler.ashx'\r\n\t},\r\n\tBudgetItemsUrl : function () {\r\n\t\treturn $C.IsDev8 ? './mock/CarryOvers.js' : '/forms/purchaseorder/_layouts/com.mizuho.sharepoint.purchaseorder/PoHandler.ashx'\r\n\t},\r\n\tCarryOverItemsUrl : function () {\r\n\t\treturn $C.IsDev8 ? './mock/BudgetItems.js' : '/forms/purchaseorder/_layouts/com.mizuho.sharepoint.purchaseorder/PoHandler.ashx'\r\n\t},\t\r\n\tInvoicesInDateRangeUrl : function () {\r\n\t\treturn $C.IsDev8 ? './mock/InvoicesInDateRange.js' : '/forms/invoice/_layouts/com.mizuho.sharepoint.portal/MrHandler.ashx'\r\n\t},\r\n\tCACHE : {},\r\n\tEXPCAT : [],\r\n\tEXCLUDEEXPCAT: ['CLEARING CHARGES PAYABLE', 'SALES TAX PAYABLE'],\r\n\tel1Name: function(code) {\r\n\t\tswitch (code)\r\n\t\t{\r\n\t\t\tcase '01': return 'FIXED INCOME DIVISION'; break;\r\n\t\t\tcase '02': return 'FUTURES DIVISION'; break;\r\n\t\t\tcase '03': return 'EQUITY DIVISION'; break;\r\n\t\t\tcase '05': return 'CORPORATE DIVISION'; break;\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn code;\r\n\t},\r\n\tel4Name : function (code) {\r\n\t\tif (code==null)\r\n\t\t\treturn \"\";\r\n\t\t\t\r\n\t\tvar sCacheKey = 'EL4CODE-' + code;\r\n\t\tif ($C.CACHE[sCacheKey]) {\r\n\t\t\t//console.log(code + \" returned from cache as \" + $C.CACHE[sCacheKey]);\r\n\t\t\treturn $C.CACHE[sCacheKey].toString();\r\n\t\t} else {\r\n\t\t\t/*first try to resolve from budget items */\r\n\t\t\tcolMatch = $.grep($V.Budget.Data, function (i) {\r\n\t\t\t\t\treturn i.Cost_x0020_Center_x000a_Number == code\r\n\t\t\t\t});\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].Cost_x0020_Center_x0020_Name.toString();\r\n\t\t\t\treturn colMatch[0].Cost_x0020_Center_x0020_Name.toString();\r\n\t\t\t}\r\n\r\n\r\n\t\t\t/*if we have a match then cache it & return it*/\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].name.toString();\r\n\t\t\t\treturn colMatch[0].name.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn code.toString();\r\n\t},\t\r\n\tel2Name : function (code) {\r\n\t\tif (code==null)\r\n\t\t\treturn \"\";\r\n\t\t\t\r\n\t\tvar sCacheKey = 'EL2CODE-' + code;\r\n\t\tif ($C.CACHE[sCacheKey]) {\r\n\t\t\t//console.log(code + \" returned from cache as \" + $C.CACHE[sCacheKey]);\r\n\t\t\treturn $C.CACHE[sCacheKey].toString();\r\n\t\t} else {\r\n\t\t\t/*first try to resolve from budget items */\r\n\t\t\tcolMatch = $.grep($V.Budget.Data, function (i) {\r\n\t\t\t\t\treturn i.BudgetGL == code\r\n\t\t\t\t});\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].Exp_x002d_Sub_x0020_Category.toString();\r\n\t\t\t\treturn colMatch[0].Exp_x002d_Sub_x0020_Category.toString();\r\n\t\t\t}\r\n\r\n\t\t\t/* check coda */\r\n\t\t\tif (colMatch.length == 0) {\r\n\t\t\t\tcolMatch = $.grep($C.EXPCAT, function (i) {\r\n\t\t\t\t\t\treturn i.code == code\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t/*if we have a match then cache it & return it*/\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].name.toString();\r\n\t\t\t\treturn colMatch[0].name.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn code.toString();\r\n\t},\r\n\tel2Code : function (name) {\r\n\t\tif (name==null)\r\n\t\t\treturn \"\";\r\n\t\t\t\r\n\t\tvar sCacheKey = 'EL2NAME-' + name;\r\n\t\tif ($C.CACHE[sCacheKey]) {\r\n\t\t\t//console.log(name + \" returned from cache as \" + $C.CACHE[sCacheKey]);\r\n\t\t\treturn $C.CACHE[sCacheKey].toString();\r\n\t\t} else {\r\n\t\t\t/*first try to resolve from budget items */\r\n\t\t\tcolMatch = $.grep($V.Budget.Data, function (i) {\r\n\t\t\t\t\treturn i.Exp_x002d_Sub_x0020_Category == name\r\n\t\t\t\t});\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].BudgetGL.toString();\r\n\t\t\t\treturn colMatch[0].BudgetGL.toString();\r\n\t\t\t}\r\n\r\n\t\t\t/* check coda */\r\n\t\t\tif (colMatch.length == 0) {\r\n\t\t\t\tcolMatch = $.grep($C.EXPCAT, function (i) {\r\n\t\t\t\t\t\treturn i.name == name\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t/*if we have a match then cache it & return it*/\r\n\t\t\tif (colMatch.length > 0) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0].code.toString();\r\n\t\t\t\treturn colMatch[0].code.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn name.toString();\r\n\t},\t\r\n\tITDept : function(budgetKey) {\r\n\t\tvar sCacheKey = 'ITDept-' + budgetKey;\r\n\t\tif ( $C.CACHE[sCacheKey] ) {\t\t\t\r\n\t\t\treturn $C.CACHE[sCacheKey].toString();\r\n\t\t} else {\r\n\t\t\tvar colMatch = $.grep($V.Budget.Data, function(i) { return i.Key == budgetKey});\r\n\t\t\tif ( colMatch.length > 0 ) {\r\n\t\t\t\t$C.CACHE[sCacheKey] = colMatch[0]['IT_x0020_Department'].toString();\r\n\t\t\t\treturn $C.CACHE[sCacheKey].toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn '';\r\n\t},\r\n\tzoomOut : function () {\r\n\t\tif (!chart) {\r\n\t\t\tchart = $('#container').highcharts();\r\n\t\t}\r\n\t\tchart.yAxis[0].setExtremes(0, chart.yAxis[0].max * 1.25, true);\r\n\t\tchart.showResetZoom();\r\n\t\treturn false;\r\n\t},\r\n\tzoomIn : function () {\r\n\t\tif (!chart) {\r\n\t\t\tchart = $('#container').highcharts();\r\n\t\t}\r\n\t\tchart.yAxis[0].setExtremes(0, chart.yAxis[0].max * 0.75, true);\r\n\t\tchart.showResetZoom();\r\n\t\treturn false;\r\n\t},\r\n\tsOptValStr : function (arr) {\r\n\t\tsStr = ':All';\r\n\t\t$.each(arr, function () {\r\n\t\t\tsStr += ';' + this + ':' + this;\r\n\t\t});\r\n\t\treturn sStr;\r\n\t},\r\n\tgridGroupClick : function (model, e, sFieldName) {\r\n\t\tvar oTarget = $(e.target);\r\n\t\tvar oGroupView = grid.getGridParam('groupingView');\r\n\t\tif (!oTarget.hasClass('btn-info')) {\r\n\t\t\tif ($.inArray(sFieldName, oGroupView.groupField) < 0) {\r\n\t\t\t\toGroupView.groupField.push(sFieldName);\r\n\t\t\t}\r\n\t\t\toTarget.addClass('btn-info');\r\n\t\t} else {\r\n\t\t\toGroupView.groupField = $.map(oGroupView.groupField, function (i) {\r\n\t\t\t\t\tif (i != sFieldName) {\r\n\t\t\t\t\t\treturn i\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\toTarget.removeClass('btn-info');\r\n\t\t}\r\n\r\n\t\t/*turn on summary for all group levels*/\r\n\t\toGroupView.groupSummary = $.map(oGroupView.groupField, function () {\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\tgrid.setGridParam({\r\n\t\t\tgrouping : oGroupView.groupField.length > 0\r\n\t\t});\r\n\t\tgrid.setGridParam({\r\n\t\t\tgroupingView : oGroupView\r\n\t\t});\r\n\t\tgrid.trigger('reloadGrid');\r\n\t\tconsole.log(oGroupView);\r\n\t},\r\n\tCarryOver: function(p_sExpCatCode) {\r\n\t\tvar colMatch = $.grep($V.CarryOver, function(i) {return i.NEW_x0020_EL2 == p_sExpCatCode})\t\r\n\t\toCarryOver = {\r\n\t\t\ty: 0,\r\n\t\t\tinvoices: [],\r\n\t\t\tdrilldown: {name: 'Carry Over: ' + $C.el2Name(p_sExpCatCode), categories:[], data:[] },\r\n\t\t\tname: $C.el2Name(p_sExpCatCode)\r\n\t\t};\r\n\t\t$.each(colMatch, function() {\r\n\t\t\toCarryOver.y += this.To_x0020_be_x0020_expensed_x0020;\r\n\t\t\tif ( this.SharePoint_x0020_Invoice.length ) { \r\n\t\t\t\tvar sInvoiceItemId = this.SharePoint_x0020_Invoice.toString().split('-')[1];\r\n\t\t\t\toCarryOver.invoices.push(sInvoiceItemId);\r\n\t\t\t\toCarryOver.drilldown.categories.push(sInvoiceItemId);\r\n\t\t\t\toCarryOver.drilldown.data.push(Math.round(this.To_x0020_be_x0020_expensed_x0020*100)/100);\r\n\t\t\t};\r\n\t\t});\r\n\t\t\r\n\t\toCarryOver.y = Math.round(oCarryOver.y * 100)/100;\r\n\t\treturn oCarryOver;\r\n\t},\r\n\tGoBack: function() {\r\n\t   subChart.destroy(); \r\n\t   $('#subBackBtn, #subChart').addClass('hide'); \r\n\t   $('#container, #chartBtns').removeClass('hide'); \t\r\n\t}\r\n}\r\n\r\nconsole.log('Loading InvoiceExpenseList: ' + $C.InvoiceExpenseListUrl());\r\n\r\n$.getJSON($C.InvoiceExpenseListUrl(), {\r\n\tget : 'InvoiceExpenseList',\r\n\t_nocache : $C.rnd\r\n}, function (json) {\r\n\t\r\n\tif ( $C.IsDev8 ) { \r\n\t\talert(json)\r\n\t\t$C.EXPCAT = json;\r\n\t}\r\n\telse {\r\n\t\t$C.EXPCAT = json;\r\n\t}\r\n\tconsole.log('Loading CarryOver');\t\r\n\t$.getJSON($C.CarryOverItemsUrl(), {\r\n\t\tget : 'CarryOvers',\r\n\t\t_nocache : $C.rnd,\r\n\t\tcontentType : 'application/json'\t\r\n\t}, function(json) {\r\n\t\r\n\t\t$V.CarryOver = []; //json;  //removing for now\r\n\t\t$V.CarryOver['ExpSubCat'] = $.distinct( $.map($V.CarryOver, function(i) {return i.NEW_x0020_EL2}));\t\t\r\n\t\tconsole.log('Loading BudgetItems');\r\n\t\t$.getJSON($C.BudgetItemsUrl(), {\r\n\t\t\tget : 'BudgetItems',\r\n\t\t\t_nocache : $C.rnd,\r\n\t\t\tcontentType : 'application/json'\r\n\t\t}, function (json) {\r\n\t\t\t$V.Budget.Data = json;\r\n\t\t\t$V.Budget.Summary = {\r\n\t\t\t\tExpSubCat : $.distinct($.map($.map($V.Budget.Data, function (i) {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tcode : i.BudgetGL,\r\n\t\t\t\t\t\t\t\tname : i.Exp_x002d_Sub_x0020_Category\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\treturn x.name < y.name ? -1 : 1\r\n\t\t\t\t\t\t}), function (i) {\r\n\t\t\t\t\t\treturn i.code.trim()\r\n\t\t\t\t\t}))\r\n\t\t\t}\r\n\t\t\t$V.Budget.Summary.Amount = $.map($V.Budget.Summary.ExpSubCat, function (c) {\r\n\t\t\t\t\tvar dTotal = 0;\r\n\t\t\t\t\t$.each($V.Budget.Data, function () {\r\n\t\t\t\t\t\tif (this.BudgetGL == c) {\r\n\t\t\t\t\t\t\tdTotal += isNaN(this.Total) ? 0 : Number(this.Total)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\t\t\tCode : c,\r\n\t\t\t\t\t\tAmount : {\r\n\t\t\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\t\t\tname : $C.el2Name(c)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\tconsole.log('Loading InvoicesInDateRange');\r\n\t\t\t$.getJSON($C.InvoicesInDateRangeUrl(), {\r\n\t\t\t\tget : 'InvoicesInDateRange',\r\n\t\t\t\tStartDate : $V.StartDate,\r\n\t\t\t\tEndDate : $V.EndDate,\r\n\t\t\t\tITInvoice: true,\r\n\t\t\t\tInStatus: 'Processed by AP,Under AP Review,Waiting for AP Approval',\r\n\t\t\t\t_nocache : $C.rnd,\r\n\t\t\t\tcontentType : 'application/json'\r\n\t\t\t}, function (json) {\r\n\t\t\t\tconsole.log('Mapping Data');\r\n\t\t\tconsole.log(json.length);\r\n\t\t\t\t\r\n\t\t\t\tvar colUniqueItTeam = [];\r\n\t\t\t\t$V.Actual.Data = json;\r\n\t\t\t\t\r\n\t\t\t\t//TODO: comment out once new code is live\r\n\t\t\t\t//$V.Actual.Data = $.grep(json, function (i) {\r\n\t\t\t\t//\t\treturn i.ITInvoice && (i.ApprovalData.CurrentWorkflowStatus == 'Processed by AP' ||\r\n\t\t\t\t//\t\t\ti.ApprovalData.CurrentWorkflowStatus == 'Under AP Review' ||\r\n\t\t\t\t//\t\t\ti.ApprovalData.CurrentWorkflowStatus == 'Waiting for AP Approval')\r\n\t\t\t\t//\t});\r\n\t\t\t\t\t\r\n\t\t\tconsole.log($V.Actual.Data.length);\r\n\r\n\t\t\t\t$V.Actual.AllocationData = $.map($V.Actual.Data, function (i) {\r\n\t\t\t\t\r\n\t\t\t\t\t\tcolValue =  $.grep(i.AllocationData.Data, function(it) {  return $.inArray($C.el2Name(it.el2), $C.EXCLUDEEXPCAT) < 0 });\r\n\t\t\t\t\t\t$.each(colValue, function () {\t\t\r\n\t\t\t\t\t\t\t\tvar sItDept = $C.ITDept(this.budgetKey);\r\n\t\t\t\t\t\t\t\tif ( sItDept == '' ) {\r\n\t\t\t\t\t\t\t\t\tsItDept = i.ITDepartment;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.InvoiceIdValue = i.InvoiceIdValue;\r\n\t\t\t\t\t\t\t\tthis.InvoiceId = i.Id;\r\n\t\t\t\t\t\t\t\tthis.ITDepartment = sItDept;\r\n\t\t\t\t\t\t\t\tthis.Budgeted = this.budgetKey != null && this.budgetKey != '' ? 'Budgeted' : 'Not Budgeted';\r\n\t\t\t\t\t\t\t\tthis.projectCode = this.projectCode == null ? '' : this.projectCode.trim();\r\n\t\t\t\t\t\t\t\tthis.projectName = this.projectName == null ? '' : this.projectName.trim();\r\n\t\t\t\t\t\t\t\tthis.el2 = this.el2 == null ? '' : this.el2.trim();\r\n\t\t\t\t\t\t\t\tthis.el2Name = this.el2Name == null ? '' : this.el2Name.trim();\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (this.ITDepartment != '' && $.inArray(this.ITDepartment, colUniqueItTeam) < 0 ) { colUniqueItTeam.push(this.ITDepartment)}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn colValue;\r\n\t\t\t\t\t});\r\n\t\t\t\t$V.Actual.Summary = {\r\n\t\t\t\t\tExpSubCat : $.distinct($.map($.map($V.Actual.Data, function (i) {\r\n\t\t\t\t\t\t\t\treturn $.map(i.AllocationData.Data, function (j) {\r\n\t\t\t\t\t\t\t\t\tif (j.el2 == null || j.el2 == \"\") {\r\n\t\t\t\t\t\t\t\t\t\tif (j.el2BookAs != null )\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t//if the el2 was never set by someone in IT then display the accounting/coda value\r\n\t\t\t\t\t\t\t\t\t\t\t//(this can happen for POs)\r\n\t\t\t\t\t\t\t\t\t\t\tj.el2 = j.el2BookAs; \r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t//set to default code to prompt someone to take action on this\r\n\t\t\t\t\t\t\t\t\t\t\tj.el2 = \"00000\"\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\tcode : j.el2,\r\n\t\t\t\t\t\t\t\t\t\tname : $C.el2Name(j.el2)\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\treturn x.name < y.name ? -1 : 1\r\n\t\t\t\t\t\t\t}), function (i) {\r\n\t\t\t\t\t\t\treturn i.code\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\tITDept: colUniqueItTeam,\r\n\t\t\t\t\tProject : $.removeEmpty($.distinct($.map($.map($V.Actual.Data, function (i) {\r\n\t\t\t\t\t\t\t\t\treturn $.map(i.AllocationData.Data, function (j) {\r\n\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\tcode : j.projectCode == null ? '' : j.projectCode,\r\n\t\t\t\t\t\t\t\t\t\t\tname : (j.projectName == null ? '' : j.projectName).trim()\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\t\treturn x.name < y.name ? -1 : 1\r\n\t\t\t\t\t\t\t\t}), function (i) {\r\n\t\t\t\t\t\t\t\treturn i.name\r\n\t\t\t\t\t\t\t}))),\r\n\t\t\t\t\tDivision : $.distinct($.map($.map($V.Actual.Data, function (i) {\r\n\t\t\t\t\t\t\t\treturn $.map(i.AllocationData.Data, function (j) {\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\tcode : j.el1,\r\n\t\t\t\t\t\t\t\t\t\tname : j.el1Name\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\treturn x.name < y.name ? -1 : 1\r\n\t\t\t\t\t\t\t}), function (i) {\r\n\t\t\t\t\t\t\treturn i.name\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\tDepartment : $.distinct($.map($.map($V.Actual.Data, function (i) {\r\n\t\t\t\t\t\t\t\treturn $.map(i.AllocationData.Data, function (j) {\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\tcode : j.el4,\r\n\t\t\t\t\t\t\t\t\t\tname : j.el4Name\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\treturn x.name < y.name ? -1 : 1\r\n\t\t\t\t\t\t\t}), function (i) {\r\n\t\t\t\t\t\t\treturn i.name\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\tBudgetKey : $.removeEmpty($.distinct($.map($V.Actual.AllocationData, function (i) {\r\n\t\t\t\t\t\t\t\treturn (i.budgetKey == null ? '' : i.budgetKey).trim()\r\n\t\t\t\t\t\t\t}))),\r\n\t\t\t\t\tBudgeted : ['Budgeted', 'Not Budgeted'],\t\t\t\t\t\t\r\n\t\t\t\t\tSpend : {}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t/* actual spend by expsubcat */\r\n\t\t\t\t/**/ \r\n\t\t\t\t$V.Actual.Summary.Spend = $.map($V.Actual.Summary.ExpSubCat,\r\n\t\t\t\t\t\tfunction (c) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcolMatch = $.grep($V.Actual.AllocationData, function (i) {\r\n\t\t\t\t\t\t\t\treturn i.el2 == c\r\n\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\treturn x.InvoiceId < y.InvoiceId ? -1 : 1\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar dTotal = 0;\r\n\t\t\t\t\t\tvar dBudgeted = 0;\r\n\t\t\t\t\t\tvar oDrillDown = {\r\n\t\t\t\t\t\t\tcategories : [],\r\n\t\t\t\t\t\t\tdata : []\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$.each(colMatch, function (i) {\r\n\t\t\t\t\t\t\tdTotal += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t\t\t\t// build a set of unique invoice's\r\n\t\t\t\t\t\t\tvar iArIdx = $.inArray(this.InvoiceId, oDrillDown.categories);\r\n\t\t\t\t\t\t\tif (iArIdx < 0) {\r\n\t\t\t\t\t\t\t\toDrillDown.categories.push(this.InvoiceId);\r\n\t\t\t\t\t\t\t\toDrillDown.data.push(isNaN(this.amount) ? 0 : Number(this.amount));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t//add the amount to data value\r\n\t\t\t\t\t\t\t\toDrillDown.data[iArIdx] += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tcolBudget = $.grep($V.Budget.Data, function (i) {\r\n\t\t\t\t\t\t\t\treturn c == i.BudgetGL\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tif (colBudget.length == 0) {\r\n\t\t\t\t\t\t\t\t//these are most likely carry over exp\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$.each(colBudget, function () {\r\n\t\t\t\t\t\t\t\t\tdBudgeted += isNaN(this.Total) ? 0 : Number(this.Total);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\t\t\t\tCode : c,\r\n\t\t\t\t\t\t\tPercent : 0,\r\n\t\t\t\t\t\t\tAmount : {\r\n\t\t\t\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\t\t\t\tname : $C.el2Name(c),\r\n\t\t\t\t\t\t\t\tdrilldown : {\r\n\t\t\t\t\t\t\t\t\tname : 'Actual Spend: ' + $C.el2Name(c),\r\n\t\t\t\t\t\t\t\t\tcategories : oDrillDown.categories,\r\n\t\t\t\t\t\t\t\t\tdata : oDrillDown.data\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tBudgeted : {\r\n\t\t\t\t\t\t\t\ty : dBudgeted\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t/*compute total spend & percentage*/\r\n\t\t\t\tconsole.log('Computing total spend & percentage');\r\n\t\t\t\tvar dTotalSpend = 0;\r\n\t\t\t\t$.each($V.Actual.Summary.Spend, function () {\r\n\t\t\t\t\tdTotalSpend += this.Amount.y\r\n\t\t\t\t});\r\n\r\n\t\t\t\t/* build a combined unique set of exp cat */\r\n\t\t\t\tconsole.log('Building unique set of exp cat data');\r\n\t\t\t\tvar colCat = []\r\n\t\t\t\t$.each($V.Actual.Summary.ExpSubCat, function () { if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t\t\t\t$.each($V.Budget.Summary.ExpSubCat, function () {if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t\t\t\t$.each($V.CarryOver.ExpSubCat, function(){colCat.push($C.el2Name(this));});\r\n\t\t\t\t\r\n\t\t\t\t//sort the exp cat's and map them back to their codes\r\n\t\t\t\tcolCat = $.distinct(colCat).sort(function (x, y) {return x < y ? -1 : 1})\t\r\n\t\t\t\tcolCat = $.map(colCat, function(i) {return {name: $C.el2Name(i), code: $C.el2Code(i)}});\r\n\t\t\t\t\r\n\t\t\t\t/*build actual dataset */\r\n\t\t\t\tvar dMaxActual = 0;\r\n\t\t\t\tvar dMaxBudget = 0;\r\n\t\t\t\tvar colActualData = [];\r\n\t\t\t\tvar colBudgetData = [];\r\n\t\t\t\tvar colCarryOverData =  [];\r\n\t\t\t\tconsole.log('Computing Budget & Actual Summary');\r\n\t\t\t\t$.each(colCat, function () {\r\n\t\t\t\t\tvar sCatName = this.name;\r\n\t\t\t\t\tvar sCatCode = this.code;\r\n\t\t\t\t\tcolMatch = $.grep($V.Actual.Summary.Spend, function (i) {\r\n\t\t\t\t\t\t\treturn i.Name == sCatName\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tvar dAmt = colMatch.length > 0 ? colMatch[0].Amount : {\r\n\t\t\t\t\t\ty : 0,\r\n\t\t\t\t\t\tname : sCatName.toString()\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcolActualData.push(dAmt);\r\n\t\t\t\t\tif (dAmt.y > dMaxActual) {\r\n\t\t\t\t\t\tdMaxActual = dAmt.y\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar colBudgetMatch = $.grep($V.Budget.Summary.Amount, function (i) {return i.Name == sCatName;});\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar dBTot =  {y : 0, name : sCatName.toString()};\t\t\t\t\t\r\n\t\t\t\t\tif (colBudgetMatch.length > 0 ) {\r\n\t\t\t\t\t\t//console.log(sCatName + \": \" + colBudgetMatch.length)\r\n\t\t\t\t\t\tdBTot = colBudgetMatch[0].Amount;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tcolBudgetData.push(dBTot);\r\n\t\t\t\t\tcolCarryOverData.push($C.CarryOver(sCatCode));\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (dBTot.y > dMaxBudget) {\r\n\t\t\t\t\t\tdMaxBudget = dBTot.y\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('Loading Chart Options');\r\n\t\t\t\t$V.chartOptions = {\r\n\t\t\t\t\t/* zoom to relative level */\r\n\t\t\t\t\tyAxis : {\r\n\t\t\t\t\t\tmax : (dMaxActual * 1.5) < dMaxBudget ? (dMaxActual * 1.5) : null\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcategories : colCat,\r\n\t\t\t\t\tseries : [{\r\n\t\t\t\t\t\t\tname : 'Budget',\r\n\t\t\t\t\t\t\tcolor : colors[9],\r\n\t\t\t\t\t\t\tpointPadding : 0.0,\r\n\t\t\t\t\t\t\tdata : colBudgetData, //$.map($V.Actual.Summary.Spend, function(i){ return i.Budgeted })\r\n\t\t\t\t\t\t\tstack: 'budget'\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Carry Over',\r\n\t\t\t\t\t\t\tcolor: colors[7],\r\n\t\t\t\t\t\t\tpointPadding: 0.0,\r\n\t\t\t\t\t\t\tdata: colCarryOverData,\r\n\t\t\t\t\t\t\tstack: 'budget'\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname : 'Actual',\r\n\t\t\t\t\t\t\tcolor : colors[6],\r\n\t\t\t\t\t\t\tpointPadding : 0.15,\r\n\t\t\t\t\t\t\tdata : colActualData, //$.map($V.Actual.Summary.Spend, function(i){ return i.Amount })\r\n\t\t\t\t\t\t\tstack: 'actual'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$('#container').html('');\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t$('[rel=tooltip]').tooltip();\r\n\t\t\t\t}, 800);\r\n\r\n\t\t\t\tdrawAreaChart($V.chartOptions);\r\n\t\t\t\tdrawPie();\r\n\t\t\t\tdrawGrid();\r\n\t\t\t\tko.applyBindings($V, document.getElementById(\"budgetMain\"));\r\n\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\nfunction drawAreaChart(options) {\r\n\t$('#chartBtns').removeClass('hide');\r\n\treturn $('#container').highcharts({\r\n\t\tchart : {\r\n\t\t\ttype : 'column',\r\n\t\t\tmargin : [50, 40, 180, 80],\r\n\t\t\twidth: '950',\r\n\t\t\theight: '600',\r\n\t\t\tzoomType : 'xy',\r\n\t\t\tresetZoomButton : {\r\n\t\t\t\tposition : {\r\n\t\t\t\t\tx : 0,\r\n\t\t\t\t\ty : -45\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\ttitle : {\r\n\t\t\ttext : 'Budget vs Actual',\r\n\t\t\talign : 'left'\r\n\t\t},\r\n\t\tsubtitle : {\r\n\t\t\ttext : 'FY2013: YTD',\r\n\t\t\talign : 'left'\r\n\t\t},\r\n\t\tlegend : {\r\n\t\t\talign : 'right',\r\n\t\t\tverticalAlign : 'top',\r\n\t\t\ty : -5,\r\n\t\t\tx : -285,\r\n\t\t\tlayout : 'horizontal'\r\n\r\n\t\t},\r\n\t\txAxis : {\r\n\t\t\ttitle : {\r\n\t\t\t\ttext : ''\r\n\t\t\t},\r\n\t\t\ttype : 'category',\r\n\t\t\tlabels : {\r\n\t\t\t\trotation: -90,\r\n\t\t\t\talign: 'right',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tfontSize: '13px',\r\n\t\t\t\t\tfontFamily: 'Verdana, sans-serif'\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tyAxis : {\r\n\t\t\ttitle : {\r\n\t\t\t\ttext : 'Amount'\r\n\t\t\t},\r\n\t\t\tendOnTick : false,\r\n\t\t\tstartOnTick : false,\r\n\t\t\tmin : 0,\r\n\t\t\tmax : options.yAxis && options.yAxis.max || null\r\n\r\n\t\t},\r\n\t\tplotOptions : {\r\n\t\t\tcolumn : {\r\n\t\t\t\tallowPointSelect : false,\r\n\t\t\t\tcursor : 'pointer',\r\n\t\t\t\tstacking : 'normal',\r\n\t\t\t\tgrouping : false,\r\n\t\t\t\tshadow : false,\r\n\t\t\t\tdataLabels : {\r\n\t\t\t\t\tenabled : false,\r\n\t\t\t\t\tformatter : function () {\r\n\t\t\t\t\t\treturn this.y;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tpoint : {\r\n\t\t\t\t\tevents : {\r\n\t\t\t\t\t\tclick : function () {\r\n\t\t\t\t\t\t\tvar drilldown = this.drilldown;\r\n\t\t\t\t\t\t\tif (drilldown) { // drill down\r\n\t\t\t\t\t\t\t\t$('#subChart, #subBackBtn').removeClass('hide');\r\n\t\t\t\t\t\t\t\t$('#container, #chartBtns').addClass('hide');\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\twindow.location.href = '#drilldown';\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tsubChart = $('#subChart').highcharts({\r\n\t\t\t\t\t\t\t\t\t\tchart : {\r\n\t\t\t\t\t\t\t\t\t\t\ttype : 'column',\r\n\t\t\t\t\t\t\t\t\t\t\tmargin : [50, 40, 180, 80],\r\n\t\t\t\t\t\t\t\t\t\t\twidth: '800',\r\n\t\t\t\t\t\t\t\t\t\t\theight: '500',\r\n\t\t\t\t\t\t\t\t\t\t\tzoomType : 'xy'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\ttitle : {\r\n\t\t\t\t\t\t\t\t\t\t\ttext : drilldown.name\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tsubtitle : {\r\n\t\t\t\t\t\t\t\t\t\t\ttext : 'Click column to view Invoice'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tlegend : {\r\n\t\t\t\t\t\t\t\t\t\t\tenabled : false,\r\n\t\t\t\t\t\t\t\t\t\t\talign : 'right',\r\n\t\t\t\t\t\t\t\t\t\t\tverticalAlign : 'top',\r\n\t\t\t\t\t\t\t\t\t\t\ty : -5,\r\n\t\t\t\t\t\t\t\t\t\t\tx : -75,\r\n\t\t\t\t\t\t\t\t\t\t\tlayout : 'vertical'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\txAxis : {\r\n\t\t\t\t\t\t\t\t\t\t\ttitle : {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttext : 'Invoice'\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tcategories : drilldown.categories,\r\n\t\t\t\t\t\t\t\t\t\t\tlabels : {\r\n\t\t\t\t\t\t\t\t\t\t\t\tenabled : true,\r\n\t\t\t\t\t\t\t\t\t\t\t\trotation : -90,\r\n\t\t\t\t\t\t\t\t\t\t\t\talign : 'right',\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle : {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize : '14px',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily : 'Arial'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tuseHTML : false\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tyAxis : {\r\n\t\t\t\t\t\t\t\t\t\t\ttitle : {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttext : 'Amount'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tplotOptions : {\r\n\t\t\t\t\t\t\t\t\t\t\tcolumn : {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcursor : 'pointer',\r\n\t\t\t\t\t\t\t\t\t\t\t\tdataLabels : {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenabled : false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinside : true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trotation : -90,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor : 'black',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatter : function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn this.x\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tshadow : false,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpoint : {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tevents : {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclick : function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topenInvoice(this.category);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\ttooltip : {\r\n\t\t\t\t\t\t\t\t\t\t\tshared : true,\r\n\t\t\t\t\t\t\t\t\t\t\theaderFormat : '<b>Invoice {point.x}</b><br />',\r\n\t\t\t\t\t\t\t\t\t\t\tpointFormat : '<span>{series.name}</span>: <b>${point.y:,.0f}</b><br/>'\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tseries : [{\r\n\t\t\t\t\t\t\t\t\t\t\t\tname : drilldown.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcolor : colors[6],\r\n\t\t\t\t\t\t\t\t\t\t\t\tfoo : 'bar',\r\n\t\t\t\t\t\t\t\t\t\t\t\tdata : drilldown.data\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t}).highcharts(); // return chart;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tarea : {\r\n\t\t\t\tmarker : {\r\n\t\t\t\t\tenabled : false,\r\n\t\t\t\t\tsymbol : 'circle',\r\n\t\t\t\t\tradius : 2,\r\n\t\t\t\t\tstates : {\r\n\t\t\t\t\t\thover : {\r\n\t\t\t\t\t\t\tenabled : true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\ttooltip : {\r\n\t\t\tshared : true,\r\n\t\t\tpointFormat : '<span>{series.name}: <b>${point.y:,.0f}</b><br/>'\r\n\t\t},\r\n\t\tseries : options.series || []\r\n\t}).highcharts(); // return chart;\r\n}\r\n\r\nfunction drawPie() {\r\n\r\n\tvar colActualBreakdown = $.map($V.Actual.Summary.Spend, function (i) {\r\n\t\t\treturn {\r\n\t\t\t\tname : i.Name,\r\n\t\t\t\ty : i.Amount.y\r\n\t\t\t}\r\n\t\t});\r\n\tconsole.log('drawing pie');\r\n\t$('#pie').highcharts({\r\n\t\tlegend : {\r\n\t\t\tlayout : 'vertical',\r\n\t\t\talign: 'right'\t\r\n\t\t},\r\n\t\tchart : {\r\n\t\t\ttype : 'pie',\t\t\t\r\n\t\t\twidth: 500,\r\n\t\t\tzoomType : 'xy'\r\n\t\t},\r\n\t\ttitle : {\r\n\t\t\ttext : 'Actual Summary',\r\n\t\t\talign: 'left'\r\n\t\t\t\r\n\t\t},\r\n\t\ttooltip : {\r\n\t\t\tformatter : function () {\r\n\t\t\t\treturn '<b>' + this.point.name + '</b>:<br /> Spend: $' + Math.round(this.y * 100) / 100 + ' (' + Math.round(this.percentage * 100) / 100 + '%)';\r\n\t\t\t}\r\n\t\t},\r\n\t\tplotOptions : {\r\n\t\t\tpie : {\r\n\t\t\t\tallowPointSelect : true,\r\n\t\t\t\tcursor : 'pointer',\r\n\t\t\t\tdataLabels : {\r\n\t\t\t\t\tenabled : false,\r\n\t\t\t\t\tdistance : -50,\r\n\t\t\t\t\tuseHTML : false,\r\n\t\t\t\t\tverticalAlign : 'top',\r\n\t\t\t\t\tcolor : '#000000',\r\n\t\t\t\t\tconnectorColor : '#000000',\r\n\t\t\t\t\tformatter : function () {\r\n\t\t\t\t\t\tconsole.log(this);\r\n\t\t\t\t\t\treturn '<div style=\"font-size:9px;\">' + this.point.name.replace(/IT-/, '').replace(/ /, '<br />').replace(/-/, '<br />') + '</div>';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshowInLegend : true\r\n\t\t\t}\r\n\t\t},\r\n\t\tseries : [{\r\n\t\t\t\ttype : 'pie',\r\n\t\t\t\tname : 'Actual Breakdown',\r\n\t\t\t\tdata : colActualBreakdown\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n}\r\n\r\nfunction openInvoice(id) {\r\n\toSearch2.select2('data', {\r\n\t\tid : id,\r\n\t\ttext : 'Invoice ' + id,\r\n\t\tattributes : [{\r\n\t\t\t\tKey : 'Type',\r\n\t\t\t\tValue : 'Invoice'\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n\tOpenS2Val();\r\n\treturn false;\r\n}\r\n\r\nfunction drawGrid() {\r\n\t$V.Grid = {};\r\n\r\n\tvar colGridData = $V.Actual.AllocationData;\r\n\t\r\n\t$.each($V.CarryOver, function() {\r\n\t\tcolGridData.push({\r\n\t\t\tInvoiceId: this.SharePoint_x0020_Invoice.length ? this.SharePoint_x0020_Invoice.toString().split('-')[1] : null,\r\n\t\t\tBudgeted: 'Carry Over',\r\n\t\t\tamount: isNaN(this.To_x0020_be_x0020_expensed_x0020) ? 0 : this.To_x0020_be_x0020_expensed_x0020,\r\n\t\t\tel1: this.Title,\r\n\t\t\tel1Name: $C.el1Name(this.Title),\r\n\t\t\tel2: this.NEW_x0020_EL2,\r\n\t\t\tel2Name: $C.el2Name(this.NEW_x0020_EL2),\r\n\t\t\tel2BookAs: this.NEW_x0020_EL2,\r\n\t\t\tel2BookAsName: $C.el2Name(this.NEW_x0020_EL2),\r\n\t\t\tel4: this.El_x0020_4,\r\n\t\t\tel4Name: $C.el4Name(this.El_x0020_4),\r\n\t\t\tInvoiceIdValue: this.Vendor\r\n\t\t});\r\n\t});\r\n\t$V.Actual.Summary.Budgeted.push('Carry Over');\r\n\t\r\n\t$('#gridControls').removeClass('hide');\r\n\r\n\tcolInvoiceId = $.distinct($.map($V.Actual.Data, function (i) {\r\n\t\t\t\treturn i.Id\r\n\t\t\t}));\r\n\t\t\t\r\n\tcolInvoiceIdValue = $.distinct($.map($V.Actual.Data, function (i) {\r\n\t\t\t\treturn i.InvoiceIdValue\r\n\t\t\t})).sort(function(x,y) { return x < y ? -1 : 1 });\t\t\t\r\n\r\n\tcolItTeam = $V.Actual.Summary.ITDept.sort(function(x,y) { return x < y ? -1 : 1 });\r\n\t\t\t\r\n\tvar sExpCatOpt = ':All';\r\n\t$.each($V.Actual.Summary.ExpSubCat, function () {\r\n\t\tif ( $.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) <0 ) {\r\n\t\t\tsExpCatOpt += ';' + this + ':' + $C.el2Name(this);\r\n\t\t}\r\n\t});\r\n\r\n\t$V.Grid.colModel = [{\r\n\t\t\tlabel : 'Invoice',\r\n\t\t\tname : 'InvoiceId',\r\n\t\t\tindex : 'InvoiceId',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colInvoiceId)\r\n\t\t\t}\r\n\t\t}, \r\n\t\t{\r\n\t\t\tlabel : 'Invoice ID',\r\n\t\t\tname : 'InvoiceIdValue',\r\n\t\t\tindex : 'InvoiceIdValue',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colInvoiceIdValue)\r\n\t\t\t}\r\n\t\t},\t\r\n\t\t{\r\n\t\t\tlabel : 'IT Dept',\r\n\t\t\tname : 'ITDepartment',\r\n\t\t\tindex : 'ITDepartment',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colItTeam)\r\n\t\t\t}\r\n\t\t},\t\t\t\t\t\r\n\t\t{\r\n\t\t\tlabel : 'Expense Category',\r\n\t\t\tname : 'el2',\r\n\t\t\tindex : 'el2',\r\n\t\t\tformatter : function (val) {\r\n\t\t\t\treturn $C.el2Name(val)\r\n\t\t\t},\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : sExpCatOpt\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Project',\r\n\t\t\tname : 'projectName',\r\n\t\t\tindex : 'projectName',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Project)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Division',\r\n\t\t\tname : 'el1Name',\r\n\t\t\tindex : 'el1Name',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Division)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Department',\r\n\t\t\tname : 'el4Name',\r\n\t\t\tindex : 'el4Name',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Department)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Budgeted',\r\n\t\t\tname : 'Budgeted',\r\n\t\t\tindex : 'Budgeted',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Budgeted)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Amount',\r\n\t\t\tname : 'amount',\r\n\t\t\tindex : 'amount',\r\n\t\t\talign : 'right',\r\n\t\t\tformatter : function(val) { return Math.round(val*100)/100; },\r\n\t\t\tsummaryType : 'sum',\r\n\t\t\tsummaryTpl: '{0}',\r\n\t\t\tsearch : false\r\n\t\t}\r\n\t];\r\n\r\n\tgrid = $(\"#grid\").jqGrid({\r\n\t\t\tdatatype : 'local',\r\n\t\t\tdata : colGridData,\r\n\t\t\t//treeGrid : false,\r\n\t\t\t//autowidth : true,\r\n\t\t\t//shrinkToFit : true,\r\n\t\t\theight : 'auto',\r\n\t\t\tcolModel : $V.Grid.colModel,\r\n\t\t\tmultiselect : false,\r\n\t\t\tgridview : true,\r\n\t\t\tviewrecords : true,\r\n\t\t\t//toppager : true,\t\t\t\r\n\t\t\trowNum : colGridData.length,\r\n\t\t\tgrouping : true,\r\n\t\t\tgroupingView : {\r\n\t\t\t\tgroupField : ['el2'],\r\n\t\t\t\tgroupOrder : ['asc','asc','asc','asc'], \r\n\t\t\t\tgroupSummary : [true],\r\n\t\t\t\tshowSummaryOnHide : true,\r\n\t\t\t\tgroupCollapse : true\t\t\r\n\t\t\t},\r\n\t\t\tondblClickRow : function (rowid, iRow, iCol, e) {\r\n\t\t\t\topenInvoice(grid.getRowData(rowid).InvoiceId);\r\n\t\t\t},\r\n\t\t\tcaption : \"Actual Spend Detail\"\r\n\t\t});\r\n\r\n\tgrid.navGrid('#gpager', {\r\n\t\tcaption:\"Export to CSV\", buttonicon:\"ui-icon\", onClickButton:ToExcel,\r\n\t\tedit : false,\r\n\t\tadd : false,\r\n\t\tdel : false\r\n\t});\r\n\tgrid.filterToolbar({\r\n\t\tautosearch : true\r\n\t});\r\n\t\r\n\t/*highlight the exp cat group by button */\r\n\t$('#groupExCat').addClass('btn-info');\r\n}\r\n\r\n\r\n$(window).on('hashchange', function(e) {\r\n\tif ( window.location.hash == '' ) {\r\n\t\t$C.GoBack();\r\n\t}\r\n});\r\n\r\n\r\nfunction ToExcel() {\r\n\tvar sUrl = 'http://msusa-portal-uat/_layouts/com.mizuho.sharepoint.portal/mrhandler.ashx?get=ToExcel';\r\n\tvar sHeaderRow = '<tr>' + $.map($V.Grid.colModel, function(i) {return '<th>' + i.label + '</th>'}).toString() + '</tr>'\r\n\tvar sBodyHtml = $('#grid')[0].innerHTML;\t\r\n\tvar oTable = $('<table />');\r\n\toTable.append(sHeaderRow);\r\n\toTable.append(sBodyHtml);\t\r\n\tvar oPayload = $('<div />');\r\n\toPayload.append(oTable);\t\r\n\t$('#ToExcelForm').remove();\r\n\tvar oForm = document.createElement('form');\r\n\toForm.method = 'POST';\r\n\toForm.action = sUrl;\r\n\toForm.id = 'ToExcelForm';\r\n\tvar oFileName = $('<input type=\"hidden\">');\r\n\toFileName.attr('id','XlsFileName');\r\n\toFileName.attr('name','XlsFileName');\r\n\toFileName.val('TheITBudgetDashboard.xls');\r\n\tvar oFileConent = $('<input type=\"hidden\" />');\r\n\toFileConent.attr('id','XlsFileContent');\r\n\toFileConent.attr('name','XlsFileContent');\r\n\toFileConent.val(oPayload.html());\r\n\t$(oForm).append(oFileName);\r\n\t$(oForm).append(oFileConent)\r\n\t$('body').append(oForm)\r\n\toForm.submit()\r\n}\r\n"]],"start1":0,"start2":0,"length1":0,"length2":30226}]],"length":30226,"saved":false}
{"ts":1370284087730,"patch":[[{"diffs":[[0,"Of('"],[-1,"file:"],[1,"shobshrpwndev01"],[0,"') >"]],"start1":1481,"start2":1481,"length1":13,"length2":23},{"diffs":[[0,"ist."],[-1,"js?callback=?"],[1,"txt"],[0,"' : "]],"start1":1626,"start2":1626,"length1":21,"length2":11},{"diffs":[[0,"ryOvers."],[-1,"js"],[1,"txt"],[0,"' : '/fo"]],"start1":1764,"start2":1764,"length1":18,"length2":19},{"diffs":[[0,"etItems."],[-1,"js"],[1,"txt"],[0,"' : '/fo"]],"start1":1937,"start2":1937,"length1":18,"length2":19},{"diffs":[[0,"teRange."],[-1,"js"],[1,"txt"],[0,"' : '/fo"]],"start1":2124,"start2":2124,"length1":18,"length2":19},{"diffs":[[0," {\r\n"],[-1,"\t"],[0,"\r\n\t"],[-1,"if ( $C.IsDev8 ) { \r\n\t\talert(json)\r\n\t\t$C.EXPCAT = json;\r\n\t}\r\n\telse {\r\n\t\t$C.EXPCAT = json;\r\n\t}"],[1,"$C.EXPCAT = json;\t"],[0,"\r\n\tc"]],"start1":8394,"start2":8394,"length1":105,"length2":29}]],"length":30153,"saved":false}
{"ts":1370284181789,"patch":[[{"diffs":[[0,"Of('"],[-1,"shobshrpwndev01"],[1,"c9.io"],[0,"') >"]],"start1":1481,"start2":1481,"length1":23,"length2":13}]],"length":30143,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294369702,"patch":[[{"diffs":[[0,"ined') {"],[-1,"var"],[0," console"]],"start1":100,"start2":100,"length1":19,"length2":16},{"diffs":[[0,"if (i !="],[1,"="],[0," \"\") {\r\n"]],"start1":1102,"start2":1102,"length1":16,"length2":17},{"diffs":[[0,"\t}\r\n\t\t})"],[1,";"],[0,"\r\n\t}\r\n})"]],"start1":1136,"start2":1136,"length1":16,"length2":17},{"diffs":[[0,"'./mock/"],[-1,"CarryOver"],[1,"BudgetItem"],[0,"s.txt' :"]],"start1":1742,"start2":1742,"length1":25,"length2":26},{"diffs":[[0,"8 ? './mock/"],[-1,"BudgetItem"],[1,"CarryOver"],[0,"s.txt' : '/f"]],"start1":1911,"start2":1911,"length1":34,"length2":33}]],"length":30142,"saved":false}
{"ts":1370294376047,"patch":[[{"diffs":[[0,"nhappy\r\n"],[1,"//"],[0,"if (type"]],"start1":62,"start2":62,"length1":16,"length2":18}]],"length":30144,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294384938,"patch":[[{"diffs":[[0,"nhappy\r\n"],[-1,"//"],[0,"if (type"]],"start1":62,"start2":62,"length1":18,"length2":16}]],"length":30142,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294395215,"patch":[[{"diffs":[[0,"ined') {"],[1,"var"],[0," console"]],"start1":100,"start2":100,"length1":16,"length2":19}]],"length":30145,"saved":false}
{"ts":1370294413454,"patch":[[{"diffs":[[0," () {}}\r"],[1,"\n\r\n//string helper\r"],[0,"\nif (!St"]],"start1":453,"start2":453,"length1":16,"length2":35}]],"length":30164,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294440840,"patch":[[{"diffs":[[0,"del */\r\n"],[1,"var "],[0,"$V = {\r\n"]],"start1":1193,"start2":1193,"length1":16,"length2":20}]],"length":30168,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294466123,"patch":[[{"diffs":[[0,"pers*/\r\n"],[1,"var "],[0,"$C = {\r\n"]],"start1":1440,"start2":1440,"length1":16,"length2":20}]],"length":30172,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294483196,"patch":[[{"diffs":[[0,"lumn*/\r\n"],[1,"Highcharts = Highcharts || {};\r\n"],[0,"Highchar"]],"start1":636,"start2":636,"length1":16,"length2":48}]],"length":30204,"saved":false}
{"ts":1370294493512,"patch":[[{"diffs":[[0,"lumn*/\r\n"],[1,"var "],[0,"Highchar"]],"start1":636,"start2":636,"length1":16,"length2":20}]],"length":30208,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294508262,"patch":[[{"diffs":[[0,"r) {"],[-1,"\r\n    \t"],[1," "],[0,"retu"]],"start1":774,"start2":774,"length1":15,"length2":9},{"diffs":[[0,"'rgba');"],[-1,"\r\n\t"],[0,"});\r\nvar"]],"start1":831,"start2":831,"length1":19,"length2":16}]],"length":30199,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294539958,"patch":[[{"diffs":[[0,"NCOME DIVISION';"],[-1," break;"],[0,"\r\n\t\t\tcase '02': "]],"start1":2437,"start2":2437,"length1":39,"length2":32},{"diffs":[[0,"TURES DIVISION';"],[-1," break;"],[0,"\r\n\t\t\tcase '03': "]],"start1":2479,"start2":2479,"length1":39,"length2":32},{"diffs":[[0,"ISION'; "],[-1,"break;"],[0,"\r\n\t\t\tcas"]],"start1":2529,"start2":2529,"length1":22,"length2":16},{"diffs":[[0,"N'; "],[-1,"break;\t"],[0,"\t\t\r\n"]],"start1":2578,"start2":2578,"length1":15,"length2":8}]],"length":30172,"saved":false}
{"ts":1370294541799,"patch":[[{"diffs":[[0,"witch (code)"],[1," "],[0,"\r\n\t\t{\r\n\t\t\tca"]],"start1":2389,"start2":2389,"length1":24,"length2":25}]],"length":30173,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294556919,"patch":[[{"diffs":[[0,"ION'; \r\n"],[-1,"\t\t\t"],[1,"            "],[0,"case '05"]],"start1":2532,"start2":2532,"length1":19,"length2":28}]],"length":30182,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294574488,"patch":[[{"diffs":[[0," {\r\n\t\tif (code=="],[1,"="],[0,"null)\r\n\t\t\treturn"]],"start1":2652,"start2":2652,"length1":32,"length2":33}]],"length":30183,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370294719886,"patch":[[{"diffs":[[0,"etItems."],[-1,"txt"],[1,"json"],[0,"' : '/fo"]],"start1":1811,"start2":1811,"length1":19,"length2":20}]],"length":30184,"saved":false}
{"ts":1370294730397,"patch":[[{"diffs":[[0,"nseList."],[-1,"txt"],[1,"json"],[0,"' : '/_l"]],"start1":1668,"start2":1668,"length1":19,"length2":20},{"diffs":[[0,"ryOvers."],[-1,"txt"],[1,"json"],[0,"' : '/fo"]],"start1":1985,"start2":1985,"length1":19,"length2":20},{"diffs":[[0,"nge."],[-1,"txt"],[1,"json"],[0,"' : "]],"start1":2177,"start2":2177,"length1":11,"length2":12}]],"length":30187,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370297299507,"patch":[[{"diffs":[[0,"\t\t\r\n"],[-1,"\t\t\t\t//TODO: comment out once new code is live\r\n\t\t\t\t//$V.Actual.Data = $.grep(json, function (i) {\r\n\t\t\t\t//\t\treturn i.ITInvoice && (i.ApprovalData.CurrentWorkflowStatus == 'Processed by AP' ||\r\n\t\t\t\t//\t\t\ti.ApprovalData.CurrentWorkflowStatus == 'Under AP Review' ||\r\n\t\t\t\t//\t\t\ti.ApprovalData.CurrentWorkflowStatus == 'Waiting for AP Approval')\r\n\t\t\t\t//\t});"],[0,"\r\n\t\t"]],"start1":10259,"start2":10259,"length1":358,"length2":8}]],"length":29837,"saved":false}
{"ts":1370297313000,"patch":[[{"diffs":[[0,"n (json) {\r\n"],[1,"                \r\n"],[0,"\t\t\t\tconsole."]],"start1":10116,"start2":10116,"length1":24,"length2":42},{"diffs":[[0,"a');"],[-1,"\r\n\t\t\tconsole.log(json.length);\r\n"],[0,"\t\t\t\t"]],"start1":10174,"start2":10174,"length1":40,"length2":8},{"diffs":[[0,"son;"],[-1,"\r\n\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\tconsole.log($V.Actual.Data.length);"],[1,"\t"],[0,"\r\n\r\n"]],"start1":10237,"start2":10237,"length1":63,"length2":9}]],"length":29769,"saved":false}
{"contributors":[],"silentsave":true,"ts":1370379065464,"patch":[[{"diffs":[[0,"}\r\n});\r\n\r\n\r\n"],[1,"\r\n\r\n"],[0,"function ToE"]],"start1":28714,"start2":28714,"length1":24,"length2":28}]],"length":29773,"saved":false}
{"ts":1370379067927,"patch":[[{"diffs":[[0,"}\r\n});\r\n\r\n\r\n"],[1,"function "],[0,"\r\n\r\nfunction"]],"start1":28714,"start2":28714,"length1":24,"length2":33}]],"length":29782,"saved":false}
{"ts":1370379070644,"patch":[[{"diffs":[[0,"unction "],[1,"B"],[0,"\r\n\r\nfunc"]],"start1":28727,"start2":28727,"length1":16,"length2":17}]],"length":29783,"saved":false}
{"ts":1370379072456,"patch":[[{"diffs":[[0,"unction "],[-1,"B"],[1,"Filter"],[0,"\r\n\r\nfunc"]],"start1":28727,"start2":28727,"length1":17,"length2":22}]],"length":29788,"saved":false}
{"ts":1370379075504,"patch":[[{"diffs":[[0,"tion"],[-1," Filter"],[0,"\r\n\r\n"]],"start1":28730,"start2":28730,"length1":15,"length2":8}]],"length":29781,"saved":false}
{"ts":1370379076461,"patch":[[{"diffs":[[0,"function"],[1," "],[0,"\r\n\r\nfunc"]],"start1":28726,"start2":28726,"length1":16,"length2":17}]],"length":29782,"saved":false}
{"ts":1370379078747,"patch":[[{"diffs":[[0,"unction "],[1,"Dim"],[0,"\r\n\r\nfunc"]],"start1":28727,"start2":28727,"length1":16,"length2":19}]],"length":29785,"saved":false}
{"ts":1370379084062,"patch":[[{"diffs":[[0,"tion Dim"],[1,"Filter() {"],[0,"\r\n\r\nfunc"]],"start1":28730,"start2":28730,"length1":16,"length2":26}]],"length":29795,"saved":false}
{"ts":1370379085190,"patch":[[{"diffs":[[0,"ter() {\r"],[1,"\n    \r\n}\r\n}\r"],[0,"\n\r\nfunct"]],"start1":28741,"start2":28741,"length1":16,"length2":28}]],"length":29807,"saved":false}
{"ts":1370379086497,"patch":[[{"diffs":[[0,"\r\n    \r\n"],[-1,"}"],[1,"    "],[0,"\r\n}\r\n\r\nf"]],"start1":28748,"start2":28748,"length1":17,"length2":20}]],"length":29810,"saved":false}
{"ts":1370379090417,"patch":[[{"diffs":[[0," {\r\n"],[-1,"    \r\n    "],[0,"\r\n}\r"]],"start1":28746,"start2":28746,"length1":18,"length2":8}]],"length":29800,"saved":false}
{"ts":1370379099106,"patch":[[{"diffs":[[0,"imFilter"],[1,"ITDept"],[0,"() {\r\n\r\n"]],"start1":28736,"start2":28736,"length1":16,"length2":22}]],"length":29806,"saved":false}
{"ts":1370379104088,"patch":[[{"diffs":[[0," Dim"],[-1,"Filter"],[0,"ITDe"]],"start1":28734,"start2":28734,"length1":14,"length2":8}]],"length":29800,"saved":false}
{"ts":1370379105330,"patch":[[{"diffs":[[0,"tion Dim"],[1,"ension"],[0,"ITDept()"]],"start1":28730,"start2":28730,"length1":16,"length2":22}]],"length":29806,"saved":false}
{"ts":1370379108260,"patch":[[{"diffs":[[0,"onITDept"],[1,"Click"],[0,"() {\r\n\r\n"]],"start1":28742,"start2":28742,"length1":16,"length2":21}]],"length":29811,"saved":false}
{"ts":1370379128423,"patch":[[{"diffs":[[0,"ck() {\r\n"],[1,"    $C.gridGroupClick(model,e,'ITDepartment');"],[0,"\r\n}\r\n\r\nf"]],"start1":28753,"start2":28753,"length1":16,"length2":62}]],"length":29857,"saved":false}
{"ts":1370379137072,"patch":[[{"diffs":[[0,"ptClick("],[1,"model,e"],[0,") {\r\n   "]],"start1":28748,"start2":28748,"length1":16,"length2":23}]],"length":29864,"saved":false}
{"ts":1370379214014,"patch":[[{"diffs":[[0,"odel,e,'"],[-1,"ITDepartment"],[0,"');\r\n}\r\n"]],"start1":28791,"start2":28791,"length1":28,"length2":16}]],"length":29852,"saved":false}
{"ts":1370379222342,"patch":[[{"diffs":[[0,"model,e,"],[-1,"''"],[0,");\r\n}\r\n\r"]],"start1":28790,"start2":28790,"length1":18,"length2":16}]],"length":29850,"saved":false}
{"ts":1370379225816,"patch":[[{"diffs":[[0,"model,e,"],[1," ''"],[0,");\r\n}\r\n\r"]],"start1":28790,"start2":28790,"length1":16,"length2":19}]],"length":29853,"saved":false}
{"ts":1370379227175,"patch":[[{"diffs":[[0," {\r\n    "],[1,"\r\n    //"],[0,"$C.gridG"]],"start1":28764,"start2":28764,"length1":16,"length2":24}]],"length":29861,"saved":false}
{"ts":1370379231332,"patch":[[{"diffs":[[0,"mensionI"],[-1,"TDept"],[0,"Click(mo"]],"start1":28737,"start2":28737,"length1":21,"length2":16}]],"length":29856,"saved":false}
{"ts":1370379232465,"patch":[[{"diffs":[[0,"imension"],[-1,"I"],[0,"Click(mo"]],"start1":28736,"start2":28736,"length1":17,"length2":16}]],"length":29855,"saved":false}
{"ts":1370379250795,"patch":[[{"diffs":[[0," {\r\n    "],[1,"c"],[0,"\r\n    //"]],"start1":28758,"start2":28758,"length1":16,"length2":17}]],"length":29856,"saved":false}
{"ts":1370379252708,"patch":[[{"diffs":[[0," {\r\n    "],[-1,"c"],[0,"\r\n    //"]],"start1":28758,"start2":28758,"length1":17,"length2":16}]],"length":29855,"saved":false}
{"ts":1370379254553,"patch":[[{"diffs":[[0," {\r\n    "],[1,"$(e.t)"],[0,"\r\n    //"]],"start1":28758,"start2":28758,"length1":16,"length2":22}]],"length":29861,"saved":false}
{"ts":1370379255401,"patch":[[{"diffs":[[0,"   $(e.t"],[1,"arg"],[0,")\r\n    /"]],"start1":28763,"start2":28763,"length1":16,"length2":19}]],"length":29864,"saved":false}
{"ts":1370379256337,"patch":[[{"diffs":[[0,"$(e.targ"],[1,"et"],[0,")\r\n    /"]],"start1":28766,"start2":28766,"length1":16,"length2":18}]],"length":29866,"saved":false}
{"ts":1370379261490,"patch":[[{"diffs":[[0,".target)"],[1,".data().dimension"],[0,"\r\n    //"]],"start1":28769,"start2":28769,"length1":16,"length2":33}]],"length":29883,"saved":false}
{"ts":1370379264459,"patch":[[{"diffs":[[0," {\r\n    "],[1,"console.log("],[0,"$(e.targ"]],"start1":28758,"start2":28758,"length1":16,"length2":28}]],"length":29895,"saved":false}
{"ts":1370379265973,"patch":[[{"diffs":[[0,"imension"],[1,")''"],[0,"\r\n    //"]],"start1":28798,"start2":28798,"length1":16,"length2":19}]],"length":29898,"saved":false}
{"ts":1370379267546,"patch":[[{"diffs":[[0,"mension)"],[-1,"''"],[0,"\r\n    //"]],"start1":28799,"start2":28799,"length1":18,"length2":16}]],"length":29896,"saved":false}
{"ts":1370379284153,"patch":[[{"diffs":[[0,"log("],[-1,"$(e.target).data().dimension"],[0,")\r\n "]],"start1":28774,"start2":28774,"length1":36,"length2":8}]],"length":29868,"saved":false}
{"ts":1370379285799,"patch":[[{"diffs":[[0,"odel,e, "],[-1,"''"],[1,"$(e.target).data().dimension"],[0,");\r\n}\r\n\r"]],"start1":28806,"start2":28806,"length1":18,"length2":44}]],"length":29894,"saved":false}
{"ts":1370379288035,"patch":[[{"diffs":[[0," {\r\n"],[-1,"    console.log()\r\n"],[0,"    "]],"start1":28758,"start2":28758,"length1":27,"length2":8}]],"length":29875,"saved":false}
{"ts":1370379289217,"patch":[[{"diffs":[[0," {\r\n    "],[-1,"//"],[0,"$C.gridG"]],"start1":28758,"start2":28758,"length1":18,"length2":16}]],"length":29873,"saved":false}
{"ts":1370379396316,"patch":[[{"diffs":[[0,"imension);\r\n"],[1,"    \r\n"],[0,"}\r\n\r\nfunctio"]],"start1":28813,"start2":28813,"length1":24,"length2":30}]],"length":29879,"saved":false}
{"ts":1370379399400,"patch":[[{"diffs":[[0,");\r\n    "],[1,"e."],[0,"\r\n}\r\n\r\nf"]],"start1":28821,"start2":28821,"length1":16,"length2":18}]],"length":29881,"saved":false}
{"ts":1370379401889,"patch":[[{"diffs":[[0,"\r\n    e."],[1,"preventDef"],[0,"\r\n}\r\n\r\nf"]],"start1":28823,"start2":28823,"length1":16,"length2":26}]],"length":29891,"saved":false}
{"ts":1370379405225,"patch":[[{"diffs":[[0,"eventDef"],[1,"ault();\r\n    return false;"],[0,"\r\n}\r\n\r\nf"]],"start1":28833,"start2":28833,"length1":16,"length2":42}]],"length":29917,"saved":false}
{"ts":1370379457668,"patch":[[{"diffs":[[0,"dGrid');\r\n\t\t"],[1,"//"],[0,"console.log("]],"start1":7193,"start2":7193,"length1":24,"length2":26}]],"length":29919,"saved":false}
{"ts":1370379461107,"patch":[[{"diffs":[[0,"\t\t\t});\r\n"],[-1,"\r\n"],[0,"\t\tgrid.s"]],"start1":7024,"start2":7024,"length1":18,"length2":16}]],"length":29917,"saved":false}
{"ts":1370379463424,"patch":[[{"diffs":[[0,";\r\n\t\t}\r\n"],[-1,"\r\n"],[0,"\t\t/*turn"]],"start1":6880,"start2":6880,"length1":18,"length2":16}]],"length":29915,"saved":false}
{"ts":1370379503417,"patch":[[{"diffs":[[0,"r) {\r\n\t\t"],[1,"var "],[0,"sStr = '"]],"start1":6259,"start2":6259,"length1":16,"length2":20}]],"length":29919,"saved":false}
{"ts":1370379511505,"patch":[[{"diffs":[[0,"et items */\r\n\t\t\t"],[1,"var "],[0,"colMatch = $.gre"]],"start1":4744,"start2":4744,"length1":32,"length2":36}]],"length":29923,"saved":false}
{"ts":1370379520928,"patch":[[{"diffs":[[0," (name=="],[1,"="],[0,"null)\r\n\t"]],"start1":4475,"start2":4475,"length1":16,"length2":17}]],"length":29924,"saved":false}
{"ts":1370379587948,"patch":[[{"diffs":[[0,"e '01': "],[1,"\r\n                "],[0,"return '"]],"start1":2419,"start2":2419,"length1":16,"length2":34},{"diffs":[[0,"e '02': "],[1,"\r\n                "],[0,"return '"]],"start1":2484,"start2":2484,"length1":16,"length2":34},{"diffs":[[0,"e '03': "],[1,"\r\n                "],[0,"return '"]],"start1":2544,"start2":2544,"length1":16,"length2":34},{"diffs":[[0,"e '05': "],[1,"\r\n                "],[0,"return '"]],"start1":2613,"start2":2613,"length1":16,"length2":34},{"diffs":[[0," (code=="],[1,"="],[0,"null)\r\n\t"]],"start1":3580,"start2":3580,"length1":16,"length2":17},{"diffs":[[0,"et items */\r\n\t\t\t"],[1,"var "],[0,"colMatch = $.gre"]],"start1":3850,"start2":3850,"length1":32,"length2":36},{"diffs":[[0,"lMatch.length =="],[1,"="],[0," 0) {\r\n\t\t\t\tcolMa"]],"start1":4175,"start2":4175,"length1":32,"length2":33},{"diffs":[[0," check coda */\r\n"],[-1,""],[0,"\t\t\tif (colMatch."]],"start1":5103,"start2":5103,"length1":32,"length2":32},{"diffs":[[0,"lMatch.length =="],[1,"="],[0," 0) {\r\n\t\t\t\tcolMa"]],"start1":5128,"start2":5128,"length1":32,"length2":33}]],"length":30003,"saved":false}
{"ts":1370379633896,"patch":[[{"diffs":[[0," (code) "],[-1,"\r\n\t\t"],[1," "],[0,"{\r\n\t\t\tca"]],"start1":2398,"start2":2398,"length1":20,"length2":17},{"diffs":[[0,"s */\r\n\t\t"],[-1,"    "],[1,"\t"],[0,"var colM"]],"start1":3010,"start2":3010,"length1":20,"length2":17}]],"length":30004,"saved":false}
{"ts":1370379709012,"patch":[[{"diffs":[[0,"tCode})\t\r\n\t\t"],[1,"var "],[0,"oCarryOver ="]],"start1":7447,"start2":7447,"length1":24,"length2":28},{"diffs":[[0,"on() {\r\n"],[-1,"\t"],[1,"     "],[0,"   subCh"]],"start1":8182,"start2":8182,"length1":17,"length2":21},{"diffs":[[0,"estroy(); \r\n"],[-1,"\t"],[1,"     "],[0,"   $('#subBa"]],"start1":8208,"start2":8208,"length1":25,"length2":29}]],"length":30016,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370379709433,"patch":[[{"diffs":[[0,"tems */\r\n\t\t\t"],[-1,"\t"],[1,"var "],[0,"colMatch = $"]],"start1":3007,"start2":3007,"length1":25,"length2":28},{"diffs":[[0,"tCode})\t\r\n\t\t"],[1,"var "],[0,"oCarryOver ="]],"start1":7447,"start2":7447,"length1":24,"length2":28},{"diffs":[[0,"on() {\r\n"],[-1,"\t"],[1,"     "],[0,"   subCh"]],"start1":8182,"start2":8182,"length1":17,"length2":21},{"diffs":[[0,"estroy(); \r\n"],[-1,"\t"],[1,"     "],[0,"   $('#subBa"]],"start1":8208,"start2":8208,"length1":25,"length2":29},{"diffs":[[0,"; \r\n"],[-1,"\t   "],[0,"$('#"]],"start1":8272,"start2":8272,"length1":12,"length2":8}]],"length":30012,"saved":false}
{"ts":1370379710449,"patch":[[{"diffs":[[0,"de'); \r\n"],[1,"        "],[0,"$('#cont"]],"start1":8268,"start2":8268,"length1":16,"length2":24}]],"length":30020,"saved":false}
{"contributors":[],"silentsave":true,"ts":1370379832491,"patch":[[{"diffs":[[0,"\r\n\t\tvar "],[-1,"var "],[0,""],[1,""],[0,"oCarryOv"]],"start1":7455,"start2":7455,"length1":20,"length2":16},{"diffs":[[0,"        "],[-1," "],[0,""],[1,""],[0,"subChart"]],"start1":8190,"start2":8190,"length1":17,"length2":16},{"diffs":[[0,"\r\n\t\t\t\t\t\t"],[-1,""],[0,""],[1,"var "],[0,"colValue"]],"start1":10422,"start2":10422,"length1":16,"length2":20},{"diffs":[[0,"tDept =="],[-1,""],[0,""],[1,"="],[0," '' ) {\r"]],"start1":10661,"start2":10661,"length1":16,"length2":17},{"diffs":[[0,"etKey !="],[1,"="],[0," null &&"]],"start1":10878,"start2":10878,"length1":16,"length2":17},{"diffs":[[0,"etKey !="],[1,"="],[0," '' ? 'B"]],"start1":10905,"start2":10905,"length1":16,"length2":17},{"diffs":[[0,"his.projectCode "],[1,"!"],[0,"== null ? '' : t"]],"start1":10978,"start2":10978,"length1":32,"length2":33},{"diffs":[[0,"his.projectName "],[1,"!"],[0,"== null ? '' : t"]],"start1":11064,"start2":11064,"length1":32,"length2":33},{"diffs":[[0," this.el2 =="],[1,"="],[0," null ? '' :"]],"start1":11140,"start2":11140,"length1":24,"length2":25},{"diffs":[[0,"s.el2Name =="],[1,"="],[0," null ? '' :"]],"start1":11210,"start2":11210,"length1":24,"length2":25},{"diffs":[[0,"tment !="],[1,"="],[0," '' && $"]],"start1":11293,"start2":11293,"length1":16,"length2":17},{"diffs":[[0,"j.el2 =="],[1,"="],[0," null ||"]],"start1":11640,"start2":11640,"length1":16,"length2":17},{"diffs":[[0,"j.el2 =="],[1,"="],[0," \"\") {\r\n"]],"start1":11658,"start2":11658,"length1":16,"length2":17},{"diffs":[[0,"ookAs !="],[1,"="],[0," null )\r"]],"start1":11695,"start2":11695,"length1":16,"length2":17},{"diffs":[[0,"ojectCode =="],[1,"="],[0," null ? '' :"]],"start1":12523,"start2":12523,"length1":24,"length2":25},{"diffs":[[0,"tName =="],[1,"="],[0," null ? "]],"start1":12592,"start2":12592,"length1":16,"length2":17},{"diffs":[[0,"etKey =="],[-1,""],[0,""],[1,"="],[0," null ? "]],"start1":13651,"start2":13651,"length1":16,"length2":17},{"diffs":[[0,"\t\t\t\t\r\n\t\t\t\t\t\t"],[-1,""],[0,""],[1,"var "],[0,"colMatch = $"]],"start1":13926,"start2":13926,"length1":24,"length2":28},{"diffs":[[0,");\r\n\r\n\t\t\t\t\t\t"],[-1,""],[0,""],[1,"var "],[0,"colBudget = "]],"start1":14784,"start2":14784,"length1":24,"length2":28},{"diffs":[[0,"ength =="],[-1,""],[0,""],[1,"="],[0," 0) {\r\n\t"]],"start1":14916,"start2":14916,"length1":16,"length2":17},{"diffs":[[0,"code;\r\n\t\t\t\t\t"],[-1,""],[0,""],[1,"var "],[0,"colMatch = $"]],"start1":16825,"start2":16825,"length1":24,"length2":28}]],"length":30051,"saved":false}
{"contributors":[],"silentsave":true,"ts":1370379878059,"patch":[[{"diffs":[[0,"colors;\r"],[1,"\nvar ko = ko || {};\r"],[0,"\n\r\n/*jq "]],"start1":909,"start2":909,"length1":16,"length2":36}]],"length":30071,"saved":false}
{"ts":1370380155170,"patch":[[{"diffs":[[0,"ojectCode = "],[1," ("],[0,"this.project"]],"start1":10985,"start2":10985,"length1":24,"length2":26},{"diffs":[[0,"ode "],[-1,"!== null ? '' : this.projectCode"],[1,"|| '')"],[0,".tri"]],"start1":11012,"start2":11012,"length1":40,"length2":14}]],"length":30047,"saved":false}
{"contributors":[],"silentsave":true,"ts":1370380526174,"patch":[[{"diffs":[[0,"tend({\r\n"],[-1,"\t"],[1,"    "],[0,"distinct"]],"start1":963,"start2":963,"length1":17,"length2":20},{"diffs":[[0,"\t\t\t\t\t}\r\n"],[-1,"\t\t\t\t\t\t\t\t"],[1,"                                \r\n                                "],[0,"this.Inv"]],"start1":10741,"start2":10741,"length1":24,"length2":82},{"diffs":[[0,".Budgeted = "],[1,"("],[0,"this.budgetK"]],"start1":10938,"start2":10938,"length1":24,"length2":25},{"diffs":[[0,"Key "],[-1,"!== null && this.budgetKey"],[1,"|| '').trim()"],[0," !=="]],"start1":10962,"start2":10962,"length1":34,"length2":21},{"diffs":[[0,"ojectName = "],[1,"("],[0,"this.project"]],"start1":11096,"start2":11096,"length1":24,"length2":25},{"diffs":[[0,"ame "],[-1,"!== null ? '' : this.projectName"],[1,"|| '')"],[0,".tri"]],"start1":11122,"start2":11122,"length1":40,"length2":14},{"diffs":[[0,"s.el2 = "],[1,"("],[0,"this.el2"]],"start1":11153,"start2":11153,"length1":16,"length2":17},{"diffs":[[0,"el2 "],[-1,"=== null ? '' : this.el2"],[1,"|| '')"],[0,".tri"]],"start1":11167,"start2":11167,"length1":32,"length2":14},{"diffs":[[0,"s.el2Name = "],[1,"("],[0,"this.el2Name"]],"start1":11198,"start2":11198,"length1":24,"length2":25},{"diffs":[[0,"ame "],[-1,"=== null ? '' : this.el2Name"],[1,"|| '')"],[0,".tri"]],"start1":11220,"start2":11220,"length1":36,"length2":14}]],"length":30033,"saved":false}
{"ts":1370380555988,"patch":[[{"diffs":[[0,"hide');\r\n\r\n\t"],[1,"var "],[0,"colInvoiceId"]],"start1":25184,"start2":25184,"length1":24,"length2":28}]],"length":30037,"saved":false}
{"ts":1370380557508,"patch":[[{"diffs":[[0,"\r\n\t\t\t\r\n\t"],[1,"var "],[0,"colInvoi"]],"start1":25288,"start2":25288,"length1":16,"length2":20}]],"length":30041,"saved":false}
{"ts":1370380559033,"patch":[[{"diffs":[[0,"\t\t\t\r\n\r\n\t"],[1,"var "],[0,"colItTea"]],"start1":25451,"start2":25451,"length1":16,"length2":20}]],"length":30045,"saved":false}
{"ts":1370380570436,"patch":[[{"diffs":[[0,".hash =="],[1,"="],[0," '' ) {\r"]],"start1":28808,"start2":28808,"length1":16,"length2":17}]],"length":30046,"saved":false}
{"ts":1370381117720,"patch":[[{"diffs":[[0,"\t\t\t}\r\n\r\n"],[-1,"\r\n"],[0,"\t\t\t/*if "]],"start1":3335,"start2":3335,"length1":18,"length2":16}]],"length":30044,"saved":false}
{"ts":1370381200071,"patch":[[{"diffs":[[0,"\t}\r\n\t\t},"],[-1,"\t\t\t\t\t"],[1,"\r\n        "],[0,"\r\n\t\t{\r\n\t"]],"start1":26430,"start2":26430,"length1":21,"length2":26}]],"length":30049,"saved":false}
{"ts":1370381201691,"patch":[[{"diffs":[[0,"},\r\n        "],[1,"{\r\n            \r\n        }\r\n        }"],[0,"\r\n\t\t{\r\n\t\t\tla"]],"start1":26436,"start2":26436,"length1":24,"length2":61}]],"length":30086,"saved":false}
{"ts":1370381203149,"patch":[[{"diffs":[[0,"       }"],[1,","],[0,"\r\n      "]],"start1":26466,"start2":26466,"length1":16,"length2":17}]],"length":30087,"saved":false}
{"ts":1370381205891,"patch":[[{"diffs":[[0,"   {\r\n          "],[1,"label: ''"],[0,"  \r\n        },\r\n"]],"start1":26445,"start2":26445,"length1":32,"length2":41}]],"length":30096,"saved":false}
{"ts":1370381207985,"patch":[[{"diffs":[[0,"label: '"],[1,"Invoic"],[0,"'  \r\n   "]],"start1":26461,"start2":26461,"length1":16,"length2":22}]],"length":30102,"saved":false}
{"ts":1370381210451,"patch":[[{"diffs":[[0," 'Invoic"],[1,"e Description"],[0,"'  \r\n   "]],"start1":26467,"start2":26467,"length1":16,"length2":29}]],"length":30115,"saved":false}
{"ts":1370381213453,"patch":[[{"diffs":[[0,"iption' "],[-1," "],[0,"\r\n      "]],"start1":26482,"start2":26482,"length1":17,"length2":16}]],"length":30114,"saved":false}
{"ts":1370381214245,"patch":[[{"diffs":[[0,"ription'"],[-1," "],[0,"\r\n      "]],"start1":26481,"start2":26481,"length1":17,"length2":16}]],"length":30113,"saved":false}
{"ts":1370381215374,"patch":[[{"diffs":[[0,"ription'"],[1,","],[0,"\r\n      "]],"start1":26481,"start2":26481,"length1":16,"length2":17}]],"length":30114,"saved":false}
{"ts":1370381265667,"patch":[[{"diffs":[[0,"tion',\r\n"],[1,"          \r\n"],[0,"        "]],"start1":26484,"start2":26484,"length1":16,"length2":28}]],"length":30126,"saved":false}
{"ts":1370381267595,"patch":[[{"diffs":[[0,"on',\r\n          "],[1,"name: ''"],[0,"\r\n        },\r\n  "]],"start1":26486,"start2":26486,"length1":32,"length2":40}]],"length":30134,"saved":false}
{"ts":1370381268593,"patch":[[{"diffs":[[0," name: '"],[1,"InvoiceIdDesc"],[0,"'\r\n     "]],"start1":26501,"start2":26501,"length1":16,"length2":29}]],"length":30147,"saved":false}
{"ts":1370381270390,"patch":[[{"diffs":[[0,"\t\tvalue : $C.sOp"],[1,","],[0,"tValStr($V.Actua"]],"start1":27545,"start2":27545,"length1":32,"length2":33}]],"length":30148,"saved":false}
{"ts":1370381271413,"patch":[[{"diffs":[[0,": $C.sOp"],[-1,","],[0,"tValStr("]],"start1":27553,"start2":27553,"length1":17,"length2":16}]],"length":30147,"saved":false}
{"ts":1370381274904,"patch":[[{"diffs":[[0,"eIdDesc'"],[1,",\r\n          "],[0,"\r\n      "]],"start1":26515,"start2":26515,"length1":16,"length2":29}]],"length":30160,"saved":false}
{"ts":1370381277693,"patch":[[{"diffs":[[0,"sc',\r\n          "],[1,"index:"],[0,"\r\n        },\r\n  "]],"start1":26520,"start2":26520,"length1":32,"length2":38}]],"length":30166,"saved":false}
{"ts":1370381279007,"patch":[[{"diffs":[[0,"  index:"],[1," 'InvoiceIdDesc'"],[0,"\r\n      "]],"start1":26534,"start2":26534,"length1":16,"length2":32}]],"length":30182,"saved":false}
{"ts":1370381280525,"patch":[[{"diffs":[[0,"eIdDesc'"],[1,",\r\n          "],[0,"\r\n      "]],"start1":26550,"start2":26550,"length1":16,"length2":29}]],"length":30195,"saved":false}
{"ts":1370381293636,"patch":[[{"diffs":[[0,"eIdDesc'"],[-1,",\r\n          "],[0,"\r\n      "]],"start1":26550,"start2":26550,"length1":29,"length2":16}]],"length":30182,"saved":false}
{"ts":1370381295943,"patch":[[{"diffs":[[0,"label: '"],[-1,"Invoice "],[0,"Descript"]],"start1":26461,"start2":26461,"length1":24,"length2":16}]],"length":30174,"saved":false}
{"ts":1370381373067,"patch":[[{"diffs":[[0,"        "],[-1,"}"],[0,"\r\n\t\t{\r\n\t"]],"start1":26564,"start2":26564,"length1":17,"length2":16}]],"length":30173,"saved":false}
{"ts":1370381374112,"patch":[[{"diffs":[[0,"    },\r\n"],[-1,"        \r\n"],[0,"\t\t{\r\n\t\t\t"]],"start1":26556,"start2":26556,"length1":26,"length2":16}]],"length":30163,"saved":false}
{"ts":1370381427414,"patch":[[{"diffs":[[0,"ceIdValue;\r\n"],[1,"                                \r\n"],[0,"\t\t\t\t\t\t\t\tthis"]],"start1":10842,"start2":10842,"length1":24,"length2":58}]],"length":30197,"saved":false}
{"ts":1370381428243,"patch":[[{"diffs":[[0,"            "],[1,"AllocationData"],[0,"\r\n\t\t\t\t\t\t\t\tth"]],"start1":10874,"start2":10874,"length1":24,"length2":38}]],"length":30211,"saved":false}
{"ts":1370381429750,"patch":[[{"diffs":[[0,"        "],[-1,"AllocationData"],[0,"\r\n\t\t\t\t\t\t"]],"start1":10878,"start2":10878,"length1":30,"length2":16}]],"length":30197,"saved":false}
{"ts":1370381434541,"patch":[[{"diffs":[[0,"            "],[1,"this.InvoiceIdDesc = i."],[0,"\r\n\t\t\t\t\t\t\t\tth"]],"start1":10874,"start2":10874,"length1":24,"length2":47}]],"length":30220,"saved":false}
{"ts":1370381437026,"patch":[[{"diffs":[[0,"dDesc = "],[-1,"i."],[0,"\r\n\t\t\t\t\t\t"]],"start1":10899,"start2":10899,"length1":18,"length2":16}]],"length":30218,"saved":false}
{"ts":1370381441955,"patch":[[{"diffs":[[0,"dDesc = "],[1,"(this.projectCode || '').trim();"],[0,"\r\n\t\t\t\t\t\t"]],"start1":10899,"start2":10899,"length1":16,"length2":48}]],"length":30250,"saved":false}
{"ts":1370381443736,"patch":[[{"diffs":[[0,"esc = (this."],[-1,"projectCode"],[1,"InvoiceIdDesc"],[0," || '').trim"]],"start1":10901,"start2":10901,"length1":35,"length2":37}]],"length":30252,"saved":false}
{"ts":1370381479092,"patch":[[{"diffs":[[0,"Desc = ("],[-1,"this"],[1,"i"],[0,".Invoice"]],"start1":10900,"start2":10900,"length1":20,"length2":17}]],"length":30249,"saved":false}
{"ts":1370381517347,"patch":[[{"diffs":[[0,"nction (i) {"],[-1,"\r\n"],[0,"\t\t\t\t\r\n\t\t\t\t\t\t"]],"start1":10425,"start2":10425,"length1":26,"length2":24}]],"length":30247,"saved":false}
{"ts":1370381519073,"patch":[[{"diffs":[[0,"\t\t\t\t\t\t\t}"],[1,"\\"],[0,"\r\n      "]],"start1":10735,"start2":10735,"length1":16,"length2":17}]],"length":30248,"saved":false}
{"ts":1370381520260,"patch":[[{"diffs":[[0,"\t\t\t}"],[-1,"\\\r\n"],[0,"    "]],"start1":10739,"start2":10739,"length1":11,"length2":8}]],"length":30245,"saved":false}
{"contributors":[],"silentsave":true,"ts":1370616437043,"patch":[[{"diffs":[[0,";\r\n}\r\n\r\n"],[1,"/* */"],[0,"\r\n$(wind"]],"start1":28934,"start2":28934,"length1":16,"length2":21}]],"length":30250,"saved":false}
{"ts":1370616438527,"patch":[[{"diffs":[[0,"\n}\r\n\r\n/*"],[1," thisi "],[0," */\r\n$(w"]],"start1":28936,"start2":28936,"length1":16,"length2":23}]],"length":30257,"saved":false}
{"ts":1370616440802,"patch":[[{"diffs":[[0,"\n/* this"],[-1,"i"],[1," is to"],[0,"  */\r\n$("]],"start1":28941,"start2":28941,"length1":17,"length2":22}]],"length":30262,"saved":false}
{"ts":1370616453907,"patch":[[{"diffs":[[0,"s is to "],[1,"catch the use of the native browser back button when drilldown is active"],[0," */\r\n$(w"]],"start1":28948,"start2":28948,"length1":16,"length2":88}]],"length":30334,"saved":false}
{"ts":1370616467368,"patch":[[{"diffs":[[0,"rn false;\r\n}\r\n\r\n"],[1,"//\r\n"],[0,"function ToExcel"]],"start1":29275,"start2":29275,"length1":32,"length2":36}]],"length":30338,"saved":false}
{"ts":1370616468185,"patch":[[{"diffs":[[0,";\r\n}\r\n\r\n"],[-1,"/"],[0,"/\r\nfunct"]],"start1":29283,"start2":29283,"length1":17,"length2":16}]],"length":30337,"saved":false}
{"ts":1370616469429,"patch":[[{"diffs":[[0,"\r\n}\r\n\r\n/"],[1,"* *"],[0,"\r\nfuncti"]],"start1":29284,"start2":29284,"length1":16,"length2":19}]],"length":30340,"saved":false}
{"ts":1370616470467,"patch":[[{"diffs":[[0,"\r\n\r\n/* *"],[1,"/"],[0,"\r\nfuncti"]],"start1":29287,"start2":29287,"length1":16,"length2":17}]],"length":30341,"saved":false}
{"ts":1370616473374,"patch":[[{"diffs":[[0,"\n}\r\n\r\n/*"],[1,"poor mans "],[0," */\r\nfun"]],"start1":29285,"start2":29285,"length1":16,"length2":26}]],"length":30351,"saved":false}
{"ts":1370616476712,"patch":[[{"diffs":[[0,"or mans "],[1,"excel export"],[0," */\r\nfun"]],"start1":29295,"start2":29295,"length1":16,"length2":28}]],"length":30363,"saved":false}
{"ts":1370616481228,"patch":[[{"diffs":[[0," export "],[1,"-  "],[0,"*/\r\nfunc"]],"start1":29308,"start2":29308,"length1":16,"length2":19}]],"length":30366,"saved":false}
{"ts":1370616483581,"patch":[[{"diffs":[[0,"l export"],[-1," -"],[0,"  */\r\nfu"]],"start1":29307,"start2":29307,"length1":18,"length2":16}]],"length":30364,"saved":false}
{"ts":1370616490583,"patch":[[{"diffs":[[0,"}\r\n});\r\n\r\n\r\n"],[1,"/* */\r\n"],[0,"function Dim"]],"start1":29131,"start2":29131,"length1":24,"length2":31}]],"length":30371,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370642211387,"patch":[[{"diffs":[[0,"n () {\r\n"],[1,"        if ( chart !== undefined) { chart.destroy() }\r\n"],[0,"\t\tchart "]],"start1":1351,"start2":1351,"length1":16,"length2":71},{"diffs":[[0,"roupView);\r\n"],[1,"        \r\n        \r\n\r\n            \r\n        \r\n"],[0,"\t},\r\n\tCarryO"]],"start1":7382,"start2":7382,"length1":24,"length2":70},{"diffs":[[0,"rl());\r\n"],[-1,"\r\n"],[0,"$.getJSO"]],"start1":8534,"start2":8534,"length1":18,"length2":16},{"diffs":[[0,"Url(), {"],[-1,"\r\n\t"],[0,"get : 'I"]],"start1":8573,"start2":8573,"length1":19,"length2":16},{"diffs":[[0,"seList',"],[-1,"\r\n\t"],[1," "],[0,"_nocache"]],"start1":8600,"start2":8600,"length1":19,"length2":17},{"diffs":[[0,": $C.rnd"],[-1,"\r\n"],[1," "],[0,"}, funct"]],"start1":8618,"start2":8618,"length1":18,"length2":17},{"diffs":[[0," = json;"],[-1,"\t"],[1,"\r\n    "],[0,"\r\n\tconso"]],"start1":8661,"start2":8661,"length1":17,"length2":22},{"diffs":[[0,"er');\t\r\n"],[-1,"\t"],[1,"    "],[0,"$.getJSO"]],"start1":8706,"start2":8706,"length1":17,"length2":20},{"diffs":[[0,"Url(), {"],[-1,"\r\n\t\t"],[1," "],[0,"get : 'C"]],"start1":8745,"start2":8745,"length1":20,"length2":17},{"diffs":[[0,"yOvers',"],[-1,"\r\n\t\t"],[1," "],[0,"_nocache"]],"start1":8765,"start2":8765,"length1":20,"length2":17},{"diffs":[[0," $C.rnd,"],[-1,"\r\n\t\t"],[1," "],[0,"contentT"]],"start1":8784,"start2":8784,"length1":20,"length2":17},{"diffs":[[0,"on/json'"],[-1,"\t\r\n"],[0,"\t}, func"]],"start1":8817,"start2":8817,"length1":19,"length2":16},{"diffs":[[0,"son) {\r\n"],[-1,"\t"],[1,"        "],[0,"\r\n\t\t$V.C"]],"start1":8839,"start2":8839,"length1":17,"length2":24},{"diffs":[[0,");\t\t\r\n\t\t"],[1,"\r\n        "],[0,"console."]],"start1":9006,"start2":9006,"length1":16,"length2":26},{"diffs":[[0,"Url(), {"],[-1,"\r\n\t\t\t"],[1," "],[0,"get : 'B"]],"start1":9087,"start2":9087,"length1":21,"length2":17},{"diffs":[[0,"tItems',"],[-1,"\r\n\t\t\t"],[1," "],[0,"_nocache"]],"start1":9108,"start2":9108,"length1":21,"length2":17},{"diffs":[[0," $C.rnd,"],[-1,"\r\n\t\t\t"],[1," "],[0,"contentT"]],"start1":9127,"start2":9127,"length1":21,"length2":17},{"diffs":[[0,"on/json'"],[-1,"\r\n\t\t"],[1," "],[0,"}, funct"]],"start1":9160,"start2":9160,"length1":20,"length2":17},{"diffs":[[0,"t = "],[-1,"$.map($V.Budget.Summary.ExpSubCat, function (c) {\r\n\t\t\t\t\tvar dTotal = 0;\r\n\t\t\t\t\t$.each($V.Budget.Data, function () {\r\n\t\t\t\t\t\tif (this.BudgetGL == c) {\r\n\t\t\t\t\t\t\tdTotal += isNaN(this.Total) ? 0 : Number(this.Total)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\t\t\tCode : c,\r\n\t\t\t\t\t\tAmount : {\r\n\t\t\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\t\t\tname : $C.el2Name(c)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}"],[1,"GetBudgetAmount("],[0,");\r\n"]],"start1":9586,"start2":9586,"length1":387,"length2":24},{"diffs":[[0," $C.rnd,"],[-1,"\r\n\t\t\t\t"],[1," "],[0,"contentT"]],"start1":9907,"start2":9907,"length1":22,"length2":17},{"diffs":[[0,"on/json'"],[-1,"\r\n\t\t\t"],[1," "],[0,"}, funct"]],"start1":9940,"start2":9940,"length1":21,"length2":17},{"diffs":[[0,"= json;\t\r\n\r\n"],[1,"                //prepare the AllocationData\r\n"],[0,"\t\t\t\t$V.Actua"]],"start1":10077,"start2":10077,"length1":24,"length2":70},{"diffs":[[0,"Budgeted';\r\n"],[1,"                                this.Recurring = (this.projectName || '').trim().toLowerCase() == 'recurring' ? 'Yes' : 'No';\r\n"],[0,"\t\t\t\t\t\t\t\tthis"]],"start1":10852,"start2":10852,"length1":24,"length2":151},{"diffs":[[0,");\r\n"],[-1,"\t\t\t\t$V.Actual.Summary = {\r\n\t\t\t\t\t"],[1,"                    \r\n                //build unique set of exp cat\r\n                var col"],[0,"ExpS"]],"start1":11418,"start2":11418,"length1":40,"length2":100},{"diffs":[[0,"var colExpSubCat"],[-1," :"],[1,"Code ="],[0," $.distinct($.ma"]],"start1":11507,"start2":11507,"length1":34,"length2":38},{"diffs":[[0,"function (i) {\r\n"],[-1,"\t"],[1,"    "],[0,"\t\t\t\t\t\t\treturn $."]],"start1":11569,"start2":11569,"length1":33,"length2":36},{"diffs":[[0,".code\r\n\t\t\t\t\t\t}))"],[-1,""],[0,""],[1,";\r\n\r\n                //this block simply builds a unique set of dimensions\r\n\t\t\t\t$V.Actual.Summary = {\r\n\t\t\t\t\tExpSubCat : colExpSubCatCode,\r\n                    ExpSubCatObj: $.map(colExpSubCatCode, function(i){ return {name: $C.el2Name(i), code: i} })"],[0,",\r\n\t\t\t\t\tITDept: "]],"start1":12307,"start2":12307,"length1":32,"length2":282},{"diffs":[[0,"\t\t\r\n"],[-1,"\t\t\t\t\tSpend : {}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t/* actual spend by expsubcat */\r\n\t\t\t\t/**/ \r\n\t\t\t\t$V.Actual.Summary.Spend = $.map($V.Actual.Summary.ExpSubCat,\r\n\t\t\t\t\t\tfunction (c) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar colMatch = $.grep($V.Actual.AllocationData, function (i) {\r\n\t\t\t\t\t\t\t\treturn i.el2 == c\r\n\t\t\t\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\t\t\t\treturn x.InvoiceId < y.InvoiceId ? -1 : 1\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar dTotal = 0;\r\n\t\t\t\t\t\tvar dBudgeted = 0;\r\n\t\t\t\t\t\tvar oDrillDown = {\r\n\t\t\t\t\t\t\tcategories : [],\r\n\t\t\t\t\t\t\tdata : []\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$.each(colMatch, function (i) {\r\n\t\t\t\t\t\t\tdTotal += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t\t\t\t// build a set of unique invoice's\r\n\t\t\t\t\t\t\tvar iArIdx = $.inArray(this.InvoiceId, oDrillDown.categories);\r\n\t\t\t\t\t\t\tif (iArIdx < 0) {\r\n\t\t\t\t\t\t\t\toDrillDown.categories.push(this.InvoiceId);\r\n\t\t\t\t\t\t\t\toDrillDown.data.push(isNaN(this.amount) ? 0 : Number(this.amount));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t//add the amount to data value\r\n\t\t\t\t\t\t\t\toDrillDown.data[iArIdx] += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t\t\t\t"],[1,"                    Recurring : ['Yes', 'No'],\r\n\t\t\t\t\tSpend : {"],[0,"}\r\n\t\t\t\t"],[-1,"\t"],[-1,"\t})"],[1,"}"],[0,";\r\n\r\n"],[-1,"\t\t\t\t\t\tvar colBudget = $.grep($V.Budget.Data, function (i) {\r\n\t\t\t\t\t\t\t\treturn c == i.BudgetGL\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tif (colBudget.length === 0) {\r\n\t\t\t\t\t\t\t\t//these are most likely carry over exp\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$.each(colBudget, function () {\r\n\t\t\t\t\t\t\t\t\tdBudgeted += isNaN(this.Total) ? 0 : Number(this.Total);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\t\t\t\tCode : c,\r\n\t\t\t\t\t\t\tPercent : 0,\r\n\t\t\t\t\t\t\tAmount : {\r\n\t\t\t\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\t\t\t\tname : $C.el2Name(c),\r\n\t\t\t\t\t\t\t\tdrilldown : {\r\n\t\t\t\t\t\t\t\t\tname : 'Actual Spend: ' + $C.el2Name(c),\r\n\t\t\t\t\t\t\t\t\tcategories : oDrillDown.categories,\r\n\t\t\t\t\t\t\t\t\tdata : oDrillDown.data\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tBudgeted : {\r\n\t\t\t\t\t\t\t\ty : dBudgeted\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t/*compute total spend & percentage*/\r\n\t\t\t\tconsole.log('Computing total spend & percentage');\r\n\t\t\t\tvar dTotalSpend = 0;\r\n\t\t\t\t$.each($V.Actual.Summary.Spend, function () {\r\n\t\t\t\t\tdTotalSpend += this.Amount.y\r\n\t\t\t\t});\r\n\r\n\t\t\t\t/* build a combined unique set of exp cat */\r\n\t\t\t\tconsole.log('Building unique set of exp cat data');\r\n\t\t\t\tvar colCat = []\r\n\t\t\t\t$.each($V.Actual.Summary.ExpSubCat, function () { if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t\t\t\t$.each($V.Budget.Summary.ExpSubCat, function () {if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t\t\t\t$.each($V.CarryOver.ExpSubCat, function(){colCat.push($C.el2Name(this));});\r\n\t\t\t\t\r\n\t\t\t\t//sort the exp cat's and map them back to their codes\r\n\t\t\t\tcolCat = $.distinct(colCat).sort(function (x, y) {return x < y ? -1 : 1})\t\r\n\t\t\t\tcolCat = $.map(colCat, function(i) {return {name: $C.el2Name(i), code: $C.el2Code(i)}});\r\n\t\t\t\t\r\n\t\t\t\t/*build actual dataset */\r\n\t\t\t\tvar dMaxActual = 0;\r\n\t\t\t\tvar dMaxBudget = 0;\r\n\t\t\t\tvar colActualData = [];\r\n\t\t\t\tvar colBudgetData = [];\r\n\t\t\t\tvar colCarryOverData =  [];\r\n\t\t\t\tconsole.log('Computing Budget & Actual Summary');\r\n\t\t\t\t$.each(colCat, function () {\r\n\t\t\t\t\tvar sCatName = this.name;\r\n\t\t\t\t\tvar sCatCode = this.code;\r\n\t\t\t\t\tvar colMatch = $.grep($V.Actual.Summary.Spend, function (i) {\r\n\t\t\t\t\t\t\treturn i.Name == sCatName\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tvar dAmt = colMatch.length > 0 ? colMatch[0].Amount : {\r\n\t\t\t\t\t\ty : 0,\r\n\t\t\t\t\t\tname : sCatName.toString()\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcolActualData.push(dAmt);\r\n\t\t\t\t\tif (dAmt.y > dMaxActual) {\r\n\t\t\t\t\t\tdMaxActual = dAmt.y\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar colBudgetMatch = $.grep($V.Budget.Summary.Amount, function (i) {return i.Name == sCatName;});\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar dBTot =  {y : 0, name : sCatName.toString()};\t\t\t\t\t\r\n\t\t\t\t\tif (colBudgetMatch.length > 0 ) {\r\n\t\t\t\t\t\t//console.log(sCatName + \": \" + colBudgetMatch.length)\r\n\t\t\t\t\t\tdBTot = colBudgetMatch[0].Amount;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tcolBudgetData.push(dBTot);\r\n\t\t\t\t\tcolCarryOverData.push($C.CarryOver(sCatCode));\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (dBTot.y > dMaxBudget) {\r\n\t\t\t\t\t\tdMaxBudget = dBTot.y\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('Loading "],[1,"                //computes actual spend \r\n                $V.Actual.Summary.Spend = GetActualSpend();\r\n\r\n\t\t\t\t//$('#container').html('');\r\n\t\t\t\tsetTimeout(function () {$('[rel=tooltip]').tooltip();}, 800);\r\n                \r\n                $V.chartOptions = Get"],[0,"Chart"],[-1," "],[0,"Options"],[-1,"'"],[1,"("],[0,");\r\n"],[-1,"\t\t\t\t$V.chartOptions = {\r\n\t\t\t\t\t/* zoom to relative level */\r\n\t\t\t\t\tyAxis : {\r\n\t\t\t\t\t\tmax : (dMaxActual * 1.5) < dMaxBudget ? (dMaxActual * 1.5) : null\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcategories : colCat,\r\n\t\t\t\t\tseries : [{\r\n\t\t\t\t\t\t\tname : 'Budget',\r\n\t\t\t\t\t\t\tcolor : colors[9],\r\n\t\t\t\t\t\t\tpointPadding : 0.0,\r\n\t\t\t\t\t\t\tdata : colBudgetData, //$.map($V.Actual.Summary.Spend, function(i){ return i.Budgeted })\r\n\t\t\t\t\t\t\tstack: 'budget'\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Carry Over',\r\n\t\t\t\t\t\t\tcolor: colors[7],\r\n\t\t\t\t\t\t\tpointPadding: 0.0,\r\n\t\t\t\t\t\t\tdata: colCarryOverData,\r\n\t\t\t\t\t\t\tstack: 'budget'\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname : 'Actual',\r\n\t\t\t\t\t\t\tcolor : colors[6],\r\n\t\t\t\t\t\t\tpointPadding : 0.15,\r\n\t\t\t\t\t\t\tdata : colActualData, //$.map($V.Actual.Summary.Spend, function(i){ return i.Amount })\r\n\t\t\t\t\t\t\tstack: 'actual'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$('#container').html('');\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t$('[rel=tooltip]').tooltip();\r\n\t\t\t\t}, 800);\r\n\r\n\t\t\t\tdrawAreaChart($V.chartOptions);"],[1,"                $V.drawChart();\r\n                "],[0,"\r\n\t\t"]],"start1":14028,"start2":14028,"length1":4934,"length2":409},{"diffs":[[0,"rawGrid();\r\n"],[1,"                \r\n"],[0,"\t\t\t\tko.apply"]],"start1":14456,"start2":14456,"length1":24,"length2":42},{"diffs":[[0,"ain\"));\r"],[1,"\n                \r\n                $('.select2').select2({}).on('change', function(){\r\n                    \r\n                    console.log($(this).val());\r\n                    \r\n                    \r\n                        var oDataOption = {\r\n                            recurring:false,\r\n                            itdept: $(this).val()\r\n                        };\r\n        \r\n                    //is recurring active?\r\n                    if ( $.inArray('Recurring', grid.getGridParam('groupingView').groupField) >= 0) {                        \r\n                        oDataOption.recurring = true;\r\n                    }\r\n                    \r\n                    \r\n                    $V.Budget.Summary.Amount = GetBudgetAmount(oDataOption);\r\n                    $V.Actual.Summary.Spend = GetActualSpend(oDataOption);\r\n                    \r\n                    //rebuild chart options based off of selection\r\n                    $V.chartOptions = GetChartOptions();\r\n                    $V.drawChart();                        \r\n                    \r\n                });\r\n                \r\n                $('#filterControls').removeClass('hide');\r\n                $('#groupControls').removeClass('hide');\r"],[0,"\n\r\n\t\t\t})"]],"start1":14543,"start2":14543,"length1":16,"length2":1231},{"diffs":[[0,"});\r\n});\r\n\r\n"],[1,"\r\n\r\n"],[0,"function dra"]],"start1":15785,"start2":15785,"length1":24,"length2":28},{"diffs":[[0,"\r\n\r\n"],[-1,"function drawGrid() {\r\n\t$V.Grid = {};\r\n\r\n\tvar colGridData = $V.Actual.AllocationData;\r\n\t\r\n\t$.each($V.CarryOver, function() {\r\n\t\tcolGridData.push({\r\n\t\t\tInvoiceId: this.SharePoint_x0020_Invoice.length ? this.SharePoint_x0020_Invoice.toString().split('-')[1] : null,\r\n\t\t\tBudgeted: 'Carry Over',\r\n\t\t\tamount: isNaN(this.To_x0020_be_x0020_expensed_x0020) ? 0 : this.To_x0020_be_x0020_expensed_x0020,\r\n\t\t\tel1: this.Title,\r\n\t\t\tel1Name: $C.el1Name(this.Title),\r\n\t\t\tel2: this.NEW_x0020_EL2,\r\n\t\t\tel2Name: $C.el2Name(this.NEW_x0020_EL2),\r\n\t\t\tel2BookAs: this.NEW_x0020_EL2,\r\n\t\t\tel2BookAsName: $C.el2Name(this.NEW_x0020_EL2),\r\n\t\t\tel4: this.El_x0020_4,\r\n\t\t\tel4Name: $C.el4Name(this.El_x0020_4),\r\n\t\t\tInvoiceIdValue: this.Vendor\r\n\t\t});\r\n\t});\r\n\t$V.Actual.Summary.Budgeted.push('Carry Over');\r\n\t\r\n\t$('#gridControls').removeClass('hide');\r\n\r\n\tvar colInvoiceId = $.distinct($.map($V.Actual.Data, function (i) {\r\n\t\t\t\treturn i.Id\r\n\t\t\t}));\r\n\t\t\t\r\n\tvar colInvoiceIdValue = $.distinct($.map($V.Actual.Data, function (i) {\r\n\t\t\t\treturn i.InvoiceIdValue\r\n\t\t\t})).sort(function(x,y) { return x < y ? -1 : 1 });\t\t\t\r\n\r\n\tvar colItTeam = $V.Actual.Summary.ITDept.sort(function(x,y) { return x < y ? -1 : 1 });\r\n\t\t\t\r\n\tvar sExpCatOpt = ':All';\r\n\t$.each($V.Actual.Summary.ExpSubCat, function () {\r\n\t\tif ( $.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) <0 ) {\r\n\t\t\tsExpCatOpt += ';' + this + ':' + $C.el2Name(this);\r\n\t\t}\r\n\t});\r\n\r\n\t$V.Grid.colModel = [{\r\n\t\t\tlabel : 'Invoice',\r\n\t\t\tname : 'InvoiceId',\r\n\t\t\tindex : 'InvoiceId',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colInvoiceId)\r\n\t\t\t}\r\n\t\t}, \r\n\t\t{\r\n\t\t\tlabel : 'Invoice ID',\r\n\t\t\tname : 'InvoiceIdValue',\r\n\t\t\tindex : 'InvoiceIdValue',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colInvoiceIdValue)\r\n\t\t\t}\r\n\t\t},\t\r\n\t\t{\r\n\t\t\tlabel : 'IT Dept',\r\n\t\t\tname : 'ITDepartment',\r\n\t\t\tindex : 'ITDepartment',\r\n\t\t\tsearch : true,\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr(colItTeam)\r\n\t\t\t}\r\n\t\t},\r\n        {\r\n          label: 'Description',\r\n          name: 'InvoiceIdDesc',\r\n          index: 'InvoiceIdDesc'\r\n        },\r\n\t\t{\r\n\t\t\tlabel : 'Expense Category',\r\n\t\t\tname : 'el2',\r\n\t\t\tindex : 'el2',\r\n\t\t\tformatter : function (val) {\r\n\t\t\t\treturn $C.el2Name(val)\r\n\t\t\t},\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : sExpCatOpt\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Project',\r\n\t\t\tname : 'projectName',\r\n\t\t\tindex : 'projectName',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Project)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Division',\r\n\t\t\tname : 'el1Name',\r\n\t\t\tindex : 'el1Name',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Division)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Department',\r\n\t\t\tname : 'el4Name',\r\n\t\t\tindex : 'el4Name',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Department)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Budgeted',\r\n\t\t\tname : 'Budgeted',\r\n\t\t\tindex : 'Budgeted',\r\n\t\t\tstype : 'select',\r\n\t\t\tsearchoptions : {\r\n\t\t\t\tsopt : ['eq'],\r\n\t\t\t\tvalue : $C.sOptValStr($V.Actual.Summary.Budgeted)\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlabel : 'Amount',\r\n\t\t\tname : 'amount',\r\n\t\t\tindex : 'amount',\r\n\t\t\talign : 'right',\r\n\t\t\tformatter : function(val) { return Math.round(val*100)/100; },\r\n\t\t\tsummaryType : 'sum',\r\n\t\t\tsummaryTpl: '{0}',\r\n\t\t\tsearch : false\r\n\t\t}\r\n\t];\r\n\r\n\tgrid = $(\"#grid\").jqGrid({\r\n\t\t\tdatatype : 'local',\r\n\t\t\tdata : colGridData,\r\n\t\t\t//treeGrid : false,\r\n\t\t\t//autowidth : true,\r\n\t\t\t//shrinkToFit : true,\r\n\t\t\theight : 'auto',\r\n\t\t\tcolModel : $V.Grid.colModel,\r\n\t\t\tmultiselect : false,\r\n\t\t\tgridview : true,\r\n\t\t\tviewrecords : true,\r\n\t\t\t//toppager : true,\t\t\t\r\n\t\t\trowNum : colGridData.length,\r\n\t\t\tgrouping : true,\r\n\t\t\tgroupingView : {\r\n\t\t\t\tgroupField : ['el2'],\r\n\t\t\t\tgroupOrder : ['asc','asc','asc','asc'], \r\n\t\t\t\tgroupSummary : [true],\r\n\t\t\t\tshowSummaryOnHide : true,\r\n\t\t\t\tgroupCollapse : true\t\t\r\n\t\t\t},\r\n\t\t\tondblClickRow : function (rowid, iRow, iCol, e) {\r\n\t\t\t\topenInvoice(grid.getRowData(rowid).InvoiceId);\r\n\t\t\t},\r\n\t\t\tcaption : \"Actual Spend Detail\"\r\n\t\t});\r\n\r\n\tgrid.navGrid('#gpager', {\r\n\t\tcaption:\"Export to CSV\", buttonicon:\"ui-icon\", onClickButton:ToExcel,\r\n\t\tedit : false,\r\n\t\tadd : false,\r\n\t\tdel : false\r\n\t});\r\n\tgrid.filterToolbar({\r\n\t\tautosearch : true"],[1,"\r\n/* this is to catch the use of the native browser back button when drilldown is active */\r\n$(window).on('hashchange', function(e) {\r\n\tif ( window.location.hash === '' ) {\r\n\t\t$C.GoBack();\r\n\t}\r\n});\r\n\r\n\r\nfunction GetActualSpend(options) {\r\n    var options = options || [];\r\n\t/* actual spend by expsubcat */\r\n\t/**/ \r\n    \r\n\treturn  $.map($V.Actual.Summary.ExpSubCat, function (c) {\r\n        \r\n\t\t\tvar colMatch = $.grep($V.Actual.AllocationData, function (i) {                \r\n                \r\n                /*check for optional filter options */\r\n                if ( options.recurring ) {                     \r\n                    if(i.projectName != 'Recurring') {\r\n                        return false;\r\n                    }                    \r\n                } \r\n                \r\n                //ITDepartment\r\n                if ( options.itdept) {\r\n                    if ( $.inArray(i.ITDepartment, options.itdept) < 0 ) {\r\n                        return false;\r\n                    }\r\n                }                \r\n\t\t\t\t\t\r\n                    \r\n                return i.el2 == c;                \r\n                    \r\n\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\treturn x.InvoiceId < y.InvoiceId ? -1 : 1\r\n\t\t\t\t});\r\n\t\t\t\r\n            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []\r\n\t\t\t}\r\n\r\n            //compute total per invoice\r\n\t\t\t$.each(colMatch, function (i) {\r\n\t\t\t\tdTotal += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t// build a set of unique invoice's\r\n\t\t\t\tvar iArIdx = $.inArray(this.InvoiceId, oDrillDown.categories);\r\n\t\t\t\tif (iArIdx < 0) {\r\n\t\t\t\t\toDrillDown.categories.push(this.InvoiceId);\r\n\t\t\t\t\toDrillDown.data.push(isNaN(this.amount) ? 0 : Number(this.amount));\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//add the amount to data value\r\n\t\t\t\t\toDrillDown.data[iArIdx] += isNaN(this.amount) ? 0 : Number(this.amount);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n            //return an for $.map\r\n\t\t    return {\r\n\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\tCode : c,\r\n\t\t\t\tPercent : 0,\r\n\t\t\t\tAmount : {\r\n\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\tname : $C.el2Name(c),\r\n\t\t\t\t\tdrilldown : {\r\n\t\t\t\t\t\tname : 'Actual Spend: ' + $C.el2Name(c),\r\n\t\t\t\t\t\tcategories : oDrillDown.categories,\r\n\t\t\t\t\t\tdata : oDrillDown.data\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});    \r\n}\r\n\r\nfunction GetGridData(options) {\r\n    return $V.Actual.AllocationData;\r\n}\r\n\r\nfunction GetBudgetAmount(options) {\r\n    var options = options || [];\r\n    return $.map($V.Budget.Summary.ExpSubCat, function (c) {\r\n\t\t\t\tvar dTotal = 0;\r\n                \r\n                \r\n\t\t\t\t$.each($V.Budget.Data, function () {\r\n\t\t\t\t\tif (this.BudgetGL == c) {\r\n                        \r\n                        \r\n                        if ( options.recurring ) {\r\n                            if ( this['Project_x0020_Name_x0020__x002f_'] != 'Recurring' ) {\r\n                                return 0;\r\n                            }\r\n                        } \r\n                        \r\n                        if ( options.itdept) {\r\n                            if ( $.inArray(this['IT_x0020_Department'], options.itdept) < 0 ) {\r\n                                return 0;\r\n                            }\r\n                        }\r\n                        \r\n\t\t\t\t\t    dTotal += isNaN(this.Total) ? 0 : Number(this.Total);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n                \r\n                \r\n\t\t\t\treturn {\r\n\t\t\t\t\tName : $C.el2Name(c),\r\n\t\t\t\t\tCode : c,\r\n\t\t\t\t\tAmount : {\r\n\t\t\t\t\t\ty : dTotal,\r\n\t\t\t\t\t\tname : $C.el2Name(c)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n}\r\n\r\n\r\nfunction GetChartOptions(options) {\r\n    \r\n    var options = options || [];\r\n    \r\n\t/* build a combined unique set of exp cat */\r\n\tconsole.log('Building unique set of exp cat data');\r\n\tvar colCat = []\r\n\t$.each($V.Actual.Summary.ExpSubCat, function () { if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t$.each($V.Budget.Summary.ExpSubCat, function () {if ($.inArray($C.el2Name(this), $C.EXCLUDEEXPCAT) < 0 ) {colCat.push($C.el2Name(this)); }});\r\n\t$.each($V.CarryOver.ExpSubCat, function(){colCat.push($C.el2Name(this));});\r\n\t\r\n\t//sort the exp cat's and map them back to their codes\r\n\tcolCat = $.distinct(colCat).sort(function (x, y) {return x < y ? -1 : 1})\t\r\n\tcolCat = $.map(colCat, function(i) {return {name: $C.el2Name(i), code: $C.el2Code(i)}});    \r\n\r\n\t/*build actual dataset */\r\n\tvar dMaxActual = 0;\r\n\tvar dMaxBudget = 0;\r\n\tvar colActualData = [];\r\n\tvar colBudgetData = [];\r\n\tvar colCarryOverData =  [];                      \r\n    \r\n\tconsole.log('Computing Budget & Actual Summary');\r\n\t$.each(colCat, function () {\r\n\t\tvar sCatName = this.name;\r\n\t\tvar sCatCode = this.code;\r\n\t\tvar colMatch = $.grep($V.Actual.Summary.Spend, function (i) {\r\n\t\t\t\treturn i.Name == sCatName\r\n\t\t\t});\r\n\t\tvar dAmt = colMatch.length > 0 ? colMatch[0].Amount : {\r\n\t\t\ty : 0,\r\n\t\t\tname : sCatName.toString()\r\n\t\t};\r\n\t\tcolActualData.push(dAmt);\r\n\t\tif (dAmt.y > dMaxActual) {\r\n\t\t\tdMaxActual = dAmt.y\r\n\t\t}\t\t\r\n\t\t\r\n\t\tvar colBudgetMatch = $.grep($V.Budget.Summary.Amount, function (i) {return i.Name == sCatName;});\t\t\t\t\t\r\n\t\tvar dBTot =  {y : 0, name : sCatName.toString()};\t\t\t\t\t\r\n\t\tif (colBudgetMatch.length > 0 ) {\r\n\t\t\t//console.log(sCatName + \": \" + colBudgetMatch.length)\r\n\t\t\tdBTot = colBudgetMatch[0].Amount;\r\n\t\t}\r\n\t\t\r\n\t\tcolBudgetData.push(dBTot);\r\n\t\tcolCarryOverData.push($C.CarryOver(sCatCode));\t\t\t\t\t\r\n\t\tif (dBTot.y > dMaxBudget) {\r\n\t\t\tdMaxBudget = dBTot.y\r\n\t\t}"],[0,"\r\n\t});\r\n"],[1,"\r\n"],[0,"\t\r\n"],[-1,"\t/*highlight the exp cat group by button */\r\n\t$('#groupExCat').addClass('btn-info');\r\n}\r\n\r\n/* this is to catch the use of the native browser back button when drilldown is active */\r\n$(window).on('hashchange', function(e) {\r\n\tif ( window.location.hash === '' ) {\r\n\t\t$C.GoBack();\r\n\t}\r\n});\r\n"],[1,"    return {\r\n\t\t/* zoom to relative level */\r\n\t\tyAxis : {\r\n\t\t\tmax : (dMaxActual * 1.5) < dMaxBudget ? (dMaxActual * 1.5) : null\r\n\t\t},\r\n\t\tcategories : colCat,\r\n\t\tseries : [{\r\n\t\t\t\tname : 'Budget',\r\n\t\t\t\tcolor : colors[9],\r\n\t\t\t\tpointPadding : 0.0,\r\n\t\t\t\tdata : colBudgetData, \r\n\t\t\t\tstack: 'budget'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Carry Over',\r\n\t\t\t\tcolor: colors[7],\r\n\t\t\t\tpointPadding: 0.0,\r\n\t\t\t\tdata: colCarryOverData,\r\n\t\t\t\tstack: 'budget'\r\n\t\t\t}, {\r\n\t\t\t\tname : 'Actual',\r\n\t\t\t\tcolor : colors[6],\r\n\t\t\t\tpointPadding : 0.15,\r\n\t\t\t\tdata : colActualData,\r\n\t\t\t\tstack: 'actual'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\r\n}"],[0,"\r\n\r\n"]],"start1":21370,"start2":21370,"length1":4694,"length2":5922}]],"length":28520,"saved":false}
{"ts":1370642233421,"patch":[[{"diffs":[[0,"\t\t\r\n"],[-1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t"]],"start1":22600,"start2":22600,"length1":118,"length2":8}]],"length":28410,"saved":false}
{"ts":1370642236632,"patch":[[{"diffs":[[0,";\r\n\t\t\t\r\n"],[1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t\t}\r\n"]],"start1":22596,"start2":22596,"length1":16,"length2":126}]],"length":28520,"saved":false}
{"ts":1370642245058,"patch":[[{"diffs":[[0,"ta : []\r\n\t\t\t"],[-1,"}"],[0,"\r\n\r\n        "]],"start1":22707,"start2":22707,"length1":25,"length2":24}]],"length":28519,"saved":false}
{"ts":1370642247571,"patch":[[{"diffs":[[0," []\r\n\t\t\t"],[1,"}"],[0,"\r\n\r\n    "]],"start1":22711,"start2":22711,"length1":16,"length2":17}]],"length":28520,"saved":false}
{"ts":1370642250727,"patch":[[{"diffs":[[0,"\t\t\r\n"],[-1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t"]],"start1":22600,"start2":22600,"length1":118,"length2":8}]],"length":28410,"saved":false}
{"ts":1370642252660,"patch":[[{"diffs":[[0,"\n\r\n\t\t\t}\r"],[1,"\n            \r\n                        var dTotal = 0;\r\n    \t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []\r"],[0,"\n\r\n     "]],"start1":22603,"start2":22603,"length1":16,"length2":157}]],"length":28551,"saved":false}
{"ts":1370642255848,"patch":[[{"diffs":[[0,"   \r"],[-1,"\n                        var dTotal = 0;\r\n    \t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []\r"],[0,"\n\r\n "]],"start1":22621,"start2":22621,"length1":135,"length2":8}]],"length":28424,"saved":false}
{"ts":1370642256837,"patch":[[{"diffs":[[0,"\n\r\n\t\t\t}\r"],[-1,"\n            \r"],[0,"\n\r\n     "]],"start1":22603,"start2":22603,"length1":30,"length2":16}]],"length":28410,"saved":false}
{"ts":1370642257874,"patch":[[{"diffs":[[0,";\r\n\t\t\t\r\n"],[1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t\t}\r\n"]],"start1":22596,"start2":22596,"length1":16,"length2":126}]],"length":28520,"saved":false}
{"ts":1370642273884,"patch":[[{"diffs":[[0,"\t\t\r\n"],[-1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t"]],"start1":22600,"start2":22600,"length1":118,"length2":8}]],"length":28410,"saved":false}
{"ts":1370642283584,"patch":[[{"diffs":[[0,";\r\n\t\t\t\r\n"],[1,"            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []"],[0,"\r\n\t\t\t}\r\n"]],"start1":22596,"start2":22596,"length1":16,"length2":126}]],"length":28520,"saved":false}
{"ts":1370642289038,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"\t\t\tvar colMatch = $.grep($V.Actual.AllocationData, function (i) {                \r\n                \r\n                /*check for optional filter options */\r\n                if ( options.recurring ) {                     \r\n                    if(i.projectName != 'Recurring') {\r\n                        return false;\r\n                    }                    \r\n                } \r\n                \r\n                //ITDepartment\r\n                if ( options.itdept) {\r\n                    if ( $.inArray(i.ITDepartment, options.itdept) < 0 ) {\r\n                        return false;\r\n                    }\r\n                }                \r\n\t\t\t\t\t\r\n                    \r\n                return i.el2 == c;                \r\n                    \r\n\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\treturn x.InvoiceId < y.InvoiceId ? -1 : 1\r\n\t\t\t\t});\r\n\t\t\t\r\n            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []\r\n\t\t\t}"],[0,"\r\n\r\n"]],"start1":21761,"start2":21761,"length1":963,"length2":8}]],"length":27565,"saved":false}
{"ts":1370642295962,"patch":[[{"diffs":[[0,"      \r\n"],[1,"    \t\tvar colMatch = $.grep($V.Actual.AllocationData, function (i) {                \r\n                \r\n                /*check for optional filter options */\r\n                if ( options.recurring ) {                     \r\n                    if(i.projectName != 'Recurring') {\r\n                        return false;\r\n                    }                    \r\n                } \r\n                \r\n                //ITDepartment\r\n                if ( options.itdept) {\r\n                    if ( $.inArray(i.ITDepartment, options.itdept) < 0 ) {\r\n                        return false;\r\n                    }\r\n                }                \r\n\t\t\t\t\t\r\n                    \r\n                return i.el2 == c;                \r\n                    \r\n\t\t\t\t}).sort(function (x, y) {\r\n\t\t\t\t\treturn x.InvoiceId < y.InvoiceId ? -1 : 1\r\n\t\t\t\t});\r\n\t\t\t\r\n            var dTotal = 0;\r\n\t\t\tvar dBudgeted = 0;\r\n\t\t\tvar oDrillDown = {\r\n\t\t\t\tcategories : [],\r\n\t\t\t\tdata : []\r\n\t\t\t}"],[0,"\r\n\r\n    "]],"start1":21757,"start2":21757,"length1":16,"length2":974}]],"length":28523,"saved":false}
{"ts":1370642299752,"patch":[[{"diffs":[[0,"            "],[1,"        "],[0,"var dTotal ="]],"start1":22607,"start2":22607,"length1":24,"length2":32}]],"length":28531,"saved":false}
{"ts":1370642306617,"patch":[[{"diffs":[[0,"{               "],[-1," "],[0,"\r\n              "]],"start1":21832,"start2":21832,"length1":33,"length2":32}]],"length":28530,"saved":false}
{"ts":1370642309947,"patch":[[{"diffs":[[0,"              } "],[-1,"\r\n"],[0,"                "]],"start1":22129,"start2":22129,"length1":34,"length2":32}]],"length":28528,"saved":false}
{"ts":1370642311372,"patch":[[{"diffs":[[0,"              } "],[1,"\r\n"],[0,"                "]],"start1":22129,"start2":22129,"length1":32,"length2":34}]],"length":28530,"saved":false}
{"ts":1370642314754,"patch":[[{"diffs":[[0,"   \r\n\t\t\t"],[-1,"\t"],[0,"}).sort("]],"start1":22508,"start2":22508,"length1":17,"length2":16}]],"length":28529,"saved":false}
{"ts":1370642319618,"patch":[[{"diffs":[[0,"(x, y) {"],[-1,"\r\n\t\t\t\t\t"],[0,"return x"]],"start1":22533,"start2":22533,"length1":23,"length2":16}]],"length":28522,"saved":false}
{"ts":1370642321750,"patch":[[{"diffs":[[0,"? -1 : 1"],[-1,"\r\n\t\t\t\t"],[0,"});\r\n\t\t\t"]],"start1":22574,"start2":22574,"length1":22,"length2":16}]],"length":28516,"saved":false}
{"ts":1370642328975,"patch":[[{"diffs":[[0,"     \r\n\t\t\t})"],[1,"\r\n            \r\n            "],[0,".sort(functi"]],"start1":22506,"start2":22506,"length1":24,"length2":52}]],"length":28544,"saved":false}
{"ts":1370642330318,"patch":[[{"diffs":[[0,"        "],[1,"//"],[0,".sort(fu"]],"start1":22538,"start2":22538,"length1":16,"length2":18}]],"length":28546,"saved":false}
{"ts":1370642333460,"patch":[[{"diffs":[[0,"            "],[-1,"        "],[0,"var dTotal ="]],"start1":22622,"start2":22622,"length1":32,"length2":24}]],"length":28538,"saved":false}
{"ts":1370642339794,"patch":[[{"diffs":[[0,"Down = {"],[-1,"\r\n\t\t\t\t"],[0,"categori"]],"start1":22687,"start2":22687,"length1":22,"length2":16}]],"length":28532,"saved":false}
{"ts":1370642341220,"patch":[[{"diffs":[[0,"es : [],"],[-1,"\r\n\t\t\t\t"],[0,"data : ["]],"start1":22703,"start2":22703,"length1":22,"length2":16}]],"length":28526,"saved":false}
{"ts":1370642342948,"patch":[[{"diffs":[[0,"ata : []"],[-1,"\r\n\t\t\t"],[1," "],[0,"}\r\n\r\n   "]],"start1":22712,"start2":22712,"length1":21,"length2":17}]],"length":28522,"saved":false}
{"ts":1370642345716,"patch":[[{"diffs":[[0,"Down = {"],[1," "],[0,"categori"]],"start1":22687,"start2":22687,"length1":16,"length2":17}]],"length":28523,"saved":false}
{"ts":1370642346649,"patch":[[{"diffs":[[0,"a : [] }"],[1,";"],[0,"\r\n\r\n    "]],"start1":22715,"start2":22715,"length1":16,"length2":17}]],"length":28524,"saved":false}
{"ts":1370642353528,"patch":[[{"diffs":[[0,"\t\t})"],[-1,"\r\n            \r\n            //"],[0,".sor"]],"start1":22514,"start2":22514,"length1":38,"length2":8}]],"length":28494,"saved":false}
{"ts":1370642355439,"patch":[[{"diffs":[[0,"            "],[-1,"    "],[0,"\r\n\t\t\t\t\t\r\n   "]],"start1":22392,"start2":22392,"length1":28,"length2":24}]],"length":28490,"saved":false}
{"ts":1370642366135,"patch":[[{"diffs":[[0,"    "],[-1,"//compute total per invoice"],[0,"\r\n\t\t"]],"start1":22702,"start2":22702,"length1":35,"length2":8}]],"length":28463,"saved":false}
{"ts":1370642367493,"patch":[[{"diffs":[[0," 1});\r\n\t\t\t\r\n"],[1,"            \r\n            //compute total per invoice\r\n"],[0,"            "]],"start1":22576,"start2":22576,"length1":24,"length2":79}]],"length":28518,"saved":false}
{"ts":1370642369506,"patch":[[{"diffs":[[0," : [] };"],[-1,"\r\n\r\n"],[0,"        "]],"start1":22737,"start2":22737,"length1":20,"length2":16}]],"length":28514,"saved":false}
{"ts":1370642552541,"patch":[[{"diffs":[[0," }          "],[-1,"  "],[0,"\r\n\t\t\t\t\t\r\n   "]],"start1":22390,"start2":22390,"length1":26,"length2":24}]],"length":28512,"saved":false}
{"ts":1370642554304,"patch":[[{"diffs":[[0,"  }         "],[-1," "],[0,"\r\n\t\t\t\t\t\r\n   "]],"start1":22389,"start2":22389,"length1":25,"length2":24}]],"length":28511,"saved":false}
{"ts":1370642555591,"patch":[[{"diffs":[[0,"      \r\n"],[-1,"\t\t\t\t\t\r\n"],[0,"        "]],"start1":22395,"start2":22395,"length1":23,"length2":16}]],"length":28504,"saved":false}
{"ts":1370642654318,"patch":[[{"diffs":[[0," 1});\r\n\t\t\t\r\n"],[1,"            $V.Actual\r\n"],[0,"            "]],"start1":22566,"start2":22566,"length1":24,"length2":47}]],"length":28527,"saved":false}
{"ts":1370642656169,"patch":[[{"diffs":[[0,"V.Actual"],[1,".Filter"],[0,"\r\n      "]],"start1":22591,"start2":22591,"length1":16,"length2":23}]],"length":28534,"saved":false}
{"ts":1370642658746,"patch":[[{"diffs":[[0,"l.Filter"],[1,"edData"],[0,"\r\n      "]],"start1":22598,"start2":22598,"length1":16,"length2":22}]],"length":28540,"saved":false}
{"ts":1370642660929,"patch":[[{"diffs":[[0,"eredData"],[1," = "],[0,"\r\n      "]],"start1":22604,"start2":22604,"length1":16,"length2":19}]],"length":28543,"saved":false}
{"ts":1370642665890,"patch":[[{"diffs":[[0,"    "],[-1,"$V.Actual.FilteredData = "],[0,"\r\n  "]],"start1":22586,"start2":22586,"length1":33,"length2":8}]],"length":28518,"saved":false}
{"ts":1370642668620,"patch":[[{"diffs":[[0,"\r\n    \t\t"],[-1,"var colMatch"],[1,"$V.Actual.FilteredData"],[0," ="],[1," "],[0," $.grep("]],"start1":21763,"start2":21763,"length1":30,"length2":41}]],"length":28529,"saved":false}
{"ts":1370642669861,"patch":[[{"diffs":[[0,"edData ="],[-1," "],[0," $.grep("]],"start1":21787,"start2":21787,"length1":17,"length2":16}]],"length":28528,"saved":false}
{"ts":1370642674094,"patch":[[{"diffs":[[0,"\r\n\t\t\t$.each("],[-1,"colMatch"],[1,"$V.Actual.FilteredData"],[0,", function ("]],"start1":22771,"start2":22771,"length1":32,"length2":46}]],"length":28542,"saved":false}
{"ts":1370642802559,"patch":[[{"diffs":[[0,"\t\t\r\n            "],[1,"console"],[0,"\r\n            \r\n"]],"start1":22584,"start2":22584,"length1":32,"length2":39}]],"length":28549,"saved":false}
{"ts":1370642807071,"patch":[[{"diffs":[[0," console"],[1,".log"],[0,"\r\n      "]],"start1":22599,"start2":22599,"length1":16,"length2":20}]],"length":28553,"saved":false}
{"ts":1370642809990,"patch":[[{"diffs":[[0,"sole.log"],[1,"($V.Actual.FilteredData)"],[0,"\r\n      "]],"start1":22603,"start2":22603,"length1":16,"length2":40}]],"length":28577,"saved":false}
{"ts":1370642826629,"patch":[[{"diffs":[[0,"    "],[-1,"console.log($V.Actual.FilteredData)"],[0,"\r\n  "]],"start1":22596,"start2":22596,"length1":43,"length2":8}]],"length":28542,"saved":false}
{"ts":1370642865736,"patch":[[{"diffs":[[0,"\r\n    \r\n"],[1,"    $V.Actual.FilteredData =\r\n"],[0,"\treturn "]],"start1":21687,"start2":21687,"length1":16,"length2":46}]],"length":28572,"saved":false}
{"ts":1370642867063,"patch":[[{"diffs":[[0,"edData ="],[1," [];"],[0,"\r\n\tretur"]],"start1":21715,"start2":21715,"length1":16,"length2":20}]],"length":28576,"saved":false}
{"ts":1370642877498,"patch":[[{"diffs":[[0,"\r\n    \t\t"],[-1,"$V.Actual.FilteredData"],[1,"var colMatch"],[0," = $.gre"]],"start1":21797,"start2":21797,"length1":38,"length2":28}]],"length":28566,"saved":false}
{"ts":1370642881616,"patch":[[{"diffs":[[0,"\t$.each("],[-1,"$V.Actual.FilteredData"],[1,"colMatch"],[0,", functi"]],"start1":22799,"start2":22799,"length1":38,"length2":24}]],"length":28552,"saved":false}
{"ts":1370642885236,"patch":[[{"diffs":[[0," {\r\n\t\t\t\t"],[1,"\r\n                "],[0,"dTotal +"]],"start1":22829,"start2":22829,"length1":16,"length2":34}]],"length":28570,"saved":false}
{"ts":1370642887934,"patch":[[{"diffs":[[0,");\r\n\t\t\t\t"],[1,"\r\n                "],[0,"// build"]],"start1":22908,"start2":22908,"length1":16,"length2":34}]],"length":28588,"saved":false}
{"ts":1370642892622,"patch":[[{"diffs":[[0,"mount);\r\n\t\t\t\t}\r\n"],[1,"                \r\n"],[0,"\t\t\t});\r\n\r\n      "]],"start1":23306,"start2":23306,"length1":32,"length2":50}]],"length":28606,"saved":false}
{"ts":1370642901007,"patch":[[{"diffs":[[0,"\t\t\r\n            "],[1,"$V.Actual.FilteredData"],[0,"\r\n            \r\n"]],"start1":22608,"start2":22608,"length1":32,"length2":54}]],"length":28628,"saved":false}
{"ts":1370642902669,"patch":[[{"diffs":[[0,"eredData"],[1,".push()"],[0,"\r\n      "]],"start1":22638,"start2":22638,"length1":16,"length2":23}]],"length":28635,"saved":false}
{"ts":1370642903417,"patch":[[{"diffs":[[0,"a.push()"],[1,";"],[0,"\r\n      "]],"start1":22645,"start2":22645,"length1":16,"length2":17}]],"length":28636,"saved":false}
{"ts":1370642906178,"patch":[[{"diffs":[[0,"ta.push("],[1,"colMatch"],[0,");\r\n    "]],"start1":22644,"start2":22644,"length1":16,"length2":24}]],"length":28644,"saved":false}
{"ts":1370642928950,"patch":[[{"diffs":[[0,"    "],[-1,"$V.Actual.FilteredData.push(colMatch);"],[0,"\r\n  "]],"start1":22620,"start2":22620,"length1":46,"length2":8}]],"length":28606,"saved":false}
{"ts":1370642932903,"patch":[[{"diffs":[[0,"on (i) {\r\n\t\t\t\t\r\n"],[1,"                $V.Actual.FilteredData.push(colMatch);\r\n                \r\n"],[0,"                "]],"start1":22823,"start2":22823,"length1":32,"length2":106}]],"length":28680,"saved":false}
{"ts":1370642935127,"patch":[[{"diffs":[[0,"ta.push("],[-1,"colMatch"],[1,"this"],[0,");\r\n    "]],"start1":22875,"start2":22875,"length1":24,"length2":20}]],"length":28676,"saved":false}
{"ts":1370642940440,"patch":[[{"diffs":[[0,"on (i) {\r\n\t\t\t\t\r\n"],[1,"                //\r\n"],[0,"                "]],"start1":22823,"start2":22823,"length1":32,"length2":52}]],"length":28696,"saved":false}
{"ts":1370642943345,"patch":[[{"diffs":[[0,"      //"],[1,"keep "],[0,"\r\n      "]],"start1":22849,"start2":22849,"length1":16,"length2":21}]],"length":28701,"saved":false}
{"ts":1370642944911,"patch":[[{"diffs":[[0," //keep "],[1,"track "],[0,"\r\n      "]],"start1":22854,"start2":22854,"length1":16,"length2":22}]],"length":28707,"saved":false}
{"ts":1370642945606,"patch":[[{"diffs":[[0,"p track "],[1,"o"],[0,"\r\n      "]],"start1":22860,"start2":22860,"length1":16,"length2":17}]],"length":28708,"saved":false}
{"ts":1370642947827,"patch":[[{"diffs":[[0,"  //"],[-1,"keep track o"],[0,"\r\n  "]],"start1":22853,"start2":22853,"length1":20,"length2":8}]],"length":28696,"saved":false}
{"ts":1370642950591,"patch":[[{"diffs":[[0,"      //"],[1,"used "],[0,"\r\n      "]],"start1":22849,"start2":22849,"length1":16,"length2":21}]],"length":28701,"saved":false}
{"ts":1370642952915,"patch":[[{"diffs":[[0," //used "],[1,"for data grid"],[0,"\r\n      "]],"start1":22854,"start2":22854,"length1":16,"length2":29}]],"length":28714,"saved":false}
{"ts":1370642991811,"patch":[[{"diffs":[[0,".Actual."],[-1,"Allocation"],[1,"Filtered"],[0,"Data"],[1," "],[0,";\r\n}\r\n\r\n"]],"start1":23855,"start2":23855,"length1":30,"length2":29}]],"length":28713,"saved":false}
{"ts":1370644275458,"patch":[[{"diffs":[[0,".val());"],[-1,"\r\n"],[0,"        "]],"start1":14699,"start2":14699,"length1":18,"length2":16}]],"length":28711,"saved":false}
{"ts":1370644279895,"patch":[[{"diffs":[[0,"wChart();   "],[1,"\r\n"],[0,"            "]],"start1":15552,"start2":15552,"length1":24,"length2":26},{"diffs":[[0,"                "],[-1," "],[1,"\r\n                    grid.GridU"],[0,"\r\n              "]],"start1":15570,"start2":15570,"length1":33,"length2":64}]],"length":28744,"saved":false}
{"ts":1370644281478,"patch":[[{"diffs":[[0,"id.GridU"],[1,"nload()"],[0,"\r\n      "]],"start1":15610,"start2":15610,"length1":16,"length2":23}]],"length":28751,"saved":false}
{"ts":1370644282489,"patch":[[{"diffs":[[0,"Unload()"],[1,"."],[0,"\r\n      "]],"start1":15617,"start2":15617,"length1":16,"length2":17}]],"length":28752,"saved":false}
{"ts":1370644284103,"patch":[[{"diffs":[[0,"Unload()"],[-1,"."],[1,";\r\n                    "],[0,"\r\n      "]],"start1":15617,"start2":15617,"length1":17,"length2":39}]],"length":28774,"saved":false}
{"ts":1370644286034,"patch":[[{"diffs":[[0,"                "],[1,"drawGr"],[0,"\r\n              "]],"start1":15632,"start2":15632,"length1":32,"length2":38}]],"length":28780,"saved":false}
{"ts":1370644287512,"patch":[[{"diffs":[[0,"  drawGr"],[1,"id()()"],[0,"\r\n      "]],"start1":15646,"start2":15646,"length1":16,"length2":22}]],"length":28786,"saved":false}
{"ts":1370644288478,"patch":[[{"diffs":[[0,"awGrid()"],[-1,"()"],[1,";"],[0,"\r\n      "]],"start1":15650,"start2":15650,"length1":18,"length2":17}]],"length":28785,"saved":false}
{"ts":1370645562626,"patch":[[{"diffs":[[0,"      //"],[1,"filter "],[0,"ITDepart"]],"start1":22281,"start2":22281,"length1":16,"length2":23}]],"length":28792,"saved":false}
{"ts":1370645566033,"patch":[[{"diffs":[[0,"partment"],[1," if selected"],[0,"\r\n      "]],"start1":22300,"start2":22300,"length1":16,"length2":28}]],"length":28804,"saved":false}
{"ts":1370645573620,"patch":[[{"diffs":[[0,"   /"],[-1,"*check for optional filter options */"],[1,"/filter Recurring "],[0,"\r\n  "]],"start1":21987,"start2":21987,"length1":45,"length2":26}]],"length":28785,"saved":false}
{"ts":1370645579315,"patch":[[{"diffs":[[0,"curring "],[1,"if selected"],[0,"\r\n      "]],"start1":22001,"start2":22001,"length1":16,"length2":27}]],"length":28796,"saved":false}
{"ts":1370645594583,"patch":[[{"diffs":[[0,"                "],[1,"//filter Recurring if selected"],[0,"\r\n              "]],"start1":24265,"start2":24265,"length1":32,"length2":62}]],"length":28826,"saved":false}
{"ts":1370645596738,"patch":[[{"diffs":[[0,"              \r\n"],[1,"                        //filter Recurring if selected\r\n"],[0,"                "]],"start1":24571,"start2":24571,"length1":32,"length2":88}]],"length":28882,"saved":false}
{"ts":1370645603311,"patch":[[{"diffs":[[0,"   //filter "],[-1,"Recurring"],[1,"ITDepartment"],[0," if selected"]],"start1":24608,"start2":24608,"length1":33,"length2":36}]],"length":28885,"saved":false}
